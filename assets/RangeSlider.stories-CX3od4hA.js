import{j as g}from"./jsx-runtime-u17CrQMm.js";import{r as m}from"./iframe-Rz6pNceq.js";import{P as l}from"./index-Dnf1k34B.js";const E=({value:v,defaultValue:D=[20,80],min:r=0,max:u=100,step:b=1,allowCross:d=!1,disabled:i=!1,onChange:y,onAfterChange:X,className:H="",name:_,...U})=>{const p=v!==void 0,k=[Math.max(r,Math.min(D[0],u)),Math.max(r,Math.min(D[1],u))];k[0]>k[1]&&k.sort((e,t)=>e-t);const[j,q]=m.useState(k),s=p?v:j,N=m.useRef(null),f=m.useRef(null),O=(e,t,n)=>Math.max(t,Math.min(e,n)),z=e=>{const t=Math.round((e-r)/b);return O(r+t*b,r,u)},C=e=>{if(!N.current)return r;const t=N.current.getBoundingClientRect(),n=O((e-t.left)/t.width,0,1),a=r+n*(u-r);return z(a)},R=(e,t)=>{i||(f.current=t,e.stopPropagation(),e.preventDefault())},P=e=>{if(i)return;const t="touches"in e?e.touches[0].clientX:e.clientX,n=C(t),a=Math.abs(s[0]-n),o=Math.abs(s[1]-n);let c;a<o?c="min":o<a?c="max":c=n<s[0]?"min":"max",f.current=c,$(n,c)},$=(e,t)=>{let n=[...s];if(t==="min"){const a=d?u:n[1];n[0]=Math.min(e,a)}else{const a=d?r:n[0];n[1]=Math.max(e,a)}p||q(n),y?.(n)};m.useCallback(e=>{if(!f.current||i)return;const t="touches"in e?e.touches[0].clientX:e.clientX,n=C(t);$(n,f.current)},[i,p,r,u,b,y,s,d]);const A=m.useRef(s);m.useEffect(()=>{A.current=s},[s]);const M=m.useCallback(e=>{if(!f.current||i)return;const t="touches"in e?e.touches[0].clientX:e.clientX,n=C(t);let a=[...A.current];if(f.current==="min"){const o=d?u:a[1];a[0]=Math.min(n,o)}else{const o=d?r:a[0];a[1]=Math.max(n,o)}p||q(a),y?.(a)},[i,p,r,u,b,y,d]),V=m.useCallback(()=>{f.current&&(f.current=null,X?.(p?v:j))},[p,v,j,X]);m.useEffect(()=>(document.addEventListener("mousemove",M),document.addEventListener("mouseup",V),document.addEventListener("touchmove",M,{passive:!1}),document.addEventListener("touchend",V),()=>{document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",V),document.removeEventListener("touchmove",M),document.removeEventListener("touchend",V)}),[M,V]);const I=(e,t)=>{if(i)return;let n=[...s];const a=t==="min"?n[0]:n[1];let o=a;if(e.key==="ArrowLeft"||e.key==="ArrowDown")o=Math.max(r,a-b);else if(e.key==="ArrowRight"||e.key==="ArrowUp")o=Math.min(u,a+b);else if(e.key==="Home")o=r;else if(e.key==="End")o=u;else return;if(t==="min"){const c=d?u:n[1];n[0]=Math.min(o,c)}else{const c=d?r:n[0];n[1]=Math.max(o,c)}p||q(n),y?.(n),e.preventDefault()},K=e=>(e-r)/(u-r)*100,L=K(s[0]),G=K(s[1]);return g.jsxs("div",{className:`wim-range-slider ${i?"wim-range-slider--disabled":""} ${H}`,onMouseDown:P,onTouchStart:P,...U,children:[g.jsxs("div",{className:"wim-range-slider__track-container",ref:N,children:[g.jsx("div",{className:"wim-range-slider__track",style:{left:`${L}%`,width:`${G-L}%`}}),g.jsx("div",{className:"wim-range-slider__thumb",style:{left:`${L}%`},role:"slider","aria-valuemin":r,"aria-valuemax":s[1],"aria-valuenow":s[0],"aria-disabled":i,tabIndex:i?-1:0,onMouseDown:e=>R(e,"min"),onTouchStart:e=>R(e,"min"),onKeyDown:e=>I(e,"min")}),g.jsx("div",{className:"wim-range-slider__thumb",style:{left:`${G}%`},role:"slider","aria-valuemin":s[0],"aria-valuemax":u,"aria-valuenow":s[1],"aria-disabled":i,tabIndex:i?-1:0,onMouseDown:e=>R(e,"max"),onTouchStart:e=>R(e,"max"),onKeyDown:e=>I(e,"max")})]}),g.jsx("input",{type:"hidden",name:_?`${_}-min`:"",value:s[0]}),g.jsx("input",{type:"hidden",name:_?`${_}-max`:"",value:s[1]})]})};E.propTypes={value:l.arrayOf(l.number),defaultValue:l.arrayOf(l.number),min:l.number,max:l.number,step:l.number,allowCross:l.bool,disabled:l.bool,onChange:l.func,onAfterChange:l.func,className:l.string,name:l.string};E.__docgenInfo={description:"範囲（開始と終了）を選択するためのスライダーコンポーネント。",methods:[],displayName:"RangeSlider",props:{value:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:"現在の値 [min, max]",type:{name:"arrayOf",value:{name:"number"}}},defaultValue:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:"デフォルトの値 [min, max]（非制御時）",defaultValue:{value:"[20, 80]",computed:!1},type:{name:"arrayOf",value:{name:"number"}}},min:{required:!1,tsType:{name:"number"},description:"最小値",defaultValue:{value:"0",computed:!1},type:{name:"number"}},max:{required:!1,tsType:{name:"number"},description:"最大値",defaultValue:{value:"100",computed:!1},type:{name:"number"}},step:{required:!1,tsType:{name:"number"},description:"ステップ値",defaultValue:{value:"1",computed:!1},type:{name:"number"}},allowCross:{required:!1,tsType:{name:"boolean"},description:"同じ値を許容するかどうか（交差はしない）",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},disabled:{required:!1,tsType:{name:"boolean"},description:"無効化フラグ",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: [number, number]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"value"}],return:{name:"void"}}},description:"値変更時のコールバック",type:{name:"func"}},onAfterChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: [number, number]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"value"}],return:{name:"void"}}},description:"ドラッグ終了時のコールバック",type:{name:"func"}},className:{required:!1,tsType:{name:"string"},description:"追加のクラス名",defaultValue:{value:'""',computed:!1},type:{name:"string"}},name:{required:!1,tsType:{name:"string"},description:`名前の属性。フォーム送信時には name-min と name-max として送信されることを想定するか、\r
あるいはJSON文字列として送信するかなど検討が必要だが、ここでは隠しinputを2つつくる。`,type:{name:"string"}}}};const B={title:"Component/Pickers & Sliders/RangeSlider",component:E,argTypes:{onChange:{action:"changed"},onAfterChange:{action:"afterChanged"}}},x={args:{defaultValue:[20,80]}},w={args:{defaultValue:[30,70],disabled:!0}},S={args:{min:-50,max:50,defaultValue:[-20,20]}},T={args:{min:0,max:100,step:10,defaultValue:[20,90]}},h=()=>{const[v,D]=m.useState([20,50]);return g.jsx(E,{value:v,onChange:D})};h.__docgenInfo={description:"",methods:[],displayName:"Controlled"};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:`{
  args: {
    defaultValue: [20, 80]
  }
}`,...x.parameters?.docs?.source}}};w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:`{
  args: {
    defaultValue: [30, 70],
    disabled: true
  }
}`,...w.parameters?.docs?.source}}};S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:`{
  args: {
    min: -50,
    max: 50,
    defaultValue: [-20, 20]
  }
}`,...S.parameters?.docs?.source}}};T.parameters={...T.parameters,docs:{...T.parameters?.docs,source:{originalSource:`{
  args: {
    min: 0,
    max: 100,
    step: 10,
    defaultValue: [20, 90]
  }
}`,...T.parameters?.docs?.source}}};h.parameters={...h.parameters,docs:{...h.parameters?.docs,source:{originalSource:`() => {
  const [val, setVal] = useState<[number, number]>([20, 50]);
  return <RangeSlider value={val} onChange={setVal} />;
}`,...h.parameters?.docs?.source}}};const J=["Default","Disabled","MinMax","Step","Controlled"],Y=Object.freeze(Object.defineProperty({__proto__:null,Controlled:h,Default:x,Disabled:w,MinMax:S,Step:T,__namedExportsOrder:J,default:B},Symbol.toStringTag,{value:"Module"}));export{h as C,w as D,S as M,Y as R,T as S};
