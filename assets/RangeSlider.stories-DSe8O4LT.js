import{j as m}from"./jsx-runtime-u17CrQMm.js";import{r as l}from"./iframe-BHaKnkIh.js";import{c as z}from"./index-DN94Dju-.js";const L=({value:f,defaultValue:S=[20,80],min:a=0,max:u=100,step:h=1,allowCross:d=!1,disabled:i=!1,onChange:D,onAfterChange:P,className:G,name:T,...H})=>{const p=f!==void 0,_=[Math.max(a,Math.min(S[0],u)),Math.max(a,Math.min(S[1],u))];_[0]>_[1]&&_.sort((e,n)=>e-n);const[E,j]=l.useState(_),s=p?f:E,q=l.useRef(null),g=l.useRef(null),k=l.useCallback((e,n,t)=>Math.max(n,Math.min(e,t)),[]),X=l.useCallback(e=>{const n=Math.round((e-a)/h);return k(a+n*h,a,u)},[k,a,u,h]),C=l.useCallback(e=>{if(!q.current)return a;const n=q.current.getBoundingClientRect(),t=k((e-n.left)/n.width,0,1),r=a+t*(u-a);return X(r)},[X,k,u,a]),R=(e,n)=>{i||(g.current=n,e.stopPropagation(),e.preventDefault())},$=e=>{if(i)return;const n="touches"in e?e.touches[0].clientX:e.clientX,t=C(n),r=Math.abs(s[0]-t),o=Math.abs(s[1]-t);let c;r<o?c="min":o<r?c="max":c=t<s[0]?"min":"max",g.current=c,U(t,c)},U=(e,n)=>{let t=[...s];if(n==="min"){const r=d?u:t[1];t[0]=Math.min(e,r)}else{const r=d?a:t[0];t[1]=Math.max(e,r)}p||j(t),D?.(t)},A=l.useRef(s);l.useEffect(()=>{A.current=s},[s]);const b=l.useCallback(e=>{if(!g.current||i)return;const n="touches"in e?e.touches[0].clientX:e.clientX,t=C(n);let r=[...A.current];if(g.current==="min"){const o=d?u:r[1];r[0]=Math.min(t,o)}else{const o=d?a:r[0];r[1]=Math.max(t,o)}p||j(r),D?.(r)},[i,p,D,d,C,a,u]),y=l.useCallback(()=>{g.current&&(g.current=null,P?.(p?f:E))},[p,f,E,P]);l.useEffect(()=>(document.addEventListener("mousemove",b),document.addEventListener("mouseup",y),document.addEventListener("touchmove",b,{passive:!1}),document.addEventListener("touchend",y),()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",y)}),[b,y]);const I=(e,n)=>{if(i)return;let t=[...s];const r=n==="min"?t[0]:t[1];let o=r;if(e.key==="ArrowLeft"||e.key==="ArrowDown")o=Math.max(a,r-h);else if(e.key==="ArrowRight"||e.key==="ArrowUp")o=Math.min(u,r+h);else if(e.key==="Home")o=a;else if(e.key==="End")o=u;else return;if(n==="min"){const c=d?u:t[1];t[0]=Math.min(o,c)}else{const c=d?a:t[0];t[1]=Math.max(o,c)}p||j(t),D?.(t),e.preventDefault()},O=e=>(e-a)/(u-a)*100,N=O(s[0]),K=O(s[1]);return m.jsxs("div",{className:z("wim-range-slider",i&&"wim-range-slider--disabled",G),onMouseDown:$,onTouchStart:$,...H,children:[m.jsxs("div",{className:"wim-range-slider__track-container",ref:q,children:[m.jsx("div",{className:"wim-range-slider__track",style:{left:`${N}%`,width:`${K-N}%`}}),m.jsx("div",{className:"wim-range-slider__thumb",style:{left:`${N}%`},role:"slider","aria-valuemin":a,"aria-valuemax":s[1],"aria-valuenow":s[0],"aria-disabled":i,tabIndex:i?-1:0,onMouseDown:e=>R(e,"min"),onTouchStart:e=>R(e,"min"),onKeyDown:e=>I(e,"min")}),m.jsx("div",{className:"wim-range-slider__thumb",style:{left:`${K}%`},role:"slider","aria-valuemin":s[0],"aria-valuemax":u,"aria-valuenow":s[1],"aria-disabled":i,tabIndex:i?-1:0,onMouseDown:e=>R(e,"max"),onTouchStart:e=>R(e,"max"),onKeyDown:e=>I(e,"max")})]}),m.jsx("input",{type:"hidden",name:T?`${T}-min`:"",value:s[0]}),m.jsx("input",{type:"hidden",name:T?`${T}-max`:"",value:s[1]})]})};L.__docgenInfo={description:"範囲（開始と終了）を選択するためのスライダーコンポーネント。",methods:[],displayName:"RangeSlider",props:{value:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:"現在の値 [min, max]"},defaultValue:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:"デフォルトの値 [min, max]（非制御時）",defaultValue:{value:"[20, 80]",computed:!1}},min:{required:!1,tsType:{name:"number"},description:"最小値",defaultValue:{value:"0",computed:!1}},max:{required:!1,tsType:{name:"number"},description:"最大値",defaultValue:{value:"100",computed:!1}},step:{required:!1,tsType:{name:"number"},description:"ステップ値",defaultValue:{value:"1",computed:!1}},allowCross:{required:!1,tsType:{name:"boolean"},description:"同じ値を許容するかどうか（交差はしない）",defaultValue:{value:"false",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:"無効化フラグ",defaultValue:{value:"false",computed:!1}},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: [number, number]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"value"}],return:{name:"void"}}},description:"値変更時のコールバック"},onAfterChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: [number, number]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"value"}],return:{name:"void"}}},description:"ドラッグ終了時のコールバック"},className:{required:!1,tsType:{name:"string"},description:"追加のクラス名"},name:{required:!1,tsType:{name:"string"},description:`名前の属性。フォーム送信時には name-min と name-max として送信されることを想定するか、\r
あるいはJSON文字列として送信するかなど検討が必要だが、ここでは隠しinputを2つつくる。`}}};const B={title:"Component/Pickers & Sliders/RangeSlider",component:L,argTypes:{onChange:{action:"changed"},onAfterChange:{action:"afterChanged"}}},M={args:{defaultValue:[20,80]}},x={args:{defaultValue:[30,70],disabled:!0}},V={args:{min:-50,max:50,defaultValue:[-20,20]}},w={args:{min:0,max:100,step:10,defaultValue:[20,90]}},v=()=>{const[f,S]=l.useState([20,50]);return m.jsx(L,{value:f,onChange:S})};v.__docgenInfo={description:"",methods:[],displayName:"Controlled"};M.parameters={...M.parameters,docs:{...M.parameters?.docs,source:{originalSource:`{
  args: {
    defaultValue: [20, 80]
  }
}`,...M.parameters?.docs?.source}}};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:`{
  args: {
    defaultValue: [30, 70],
    disabled: true
  }
}`,...x.parameters?.docs?.source}}};V.parameters={...V.parameters,docs:{...V.parameters?.docs,source:{originalSource:`{
  args: {
    min: -50,
    max: 50,
    defaultValue: [-20, 20]
  }
}`,...V.parameters?.docs?.source}}};w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:`{
  args: {
    min: 0,
    max: 100,
    step: 10,
    defaultValue: [20, 90]
  }
}`,...w.parameters?.docs?.source}}};v.parameters={...v.parameters,docs:{...v.parameters?.docs,source:{originalSource:`() => {
  const [val, setVal] = useState<[number, number]>([20, 50]);
  return <RangeSlider value={val} onChange={setVal} />;
}`,...v.parameters?.docs?.source}}};const J=["Default","Disabled","MinMax","Step","Controlled"],Y=Object.freeze(Object.defineProperty({__proto__:null,Controlled:v,Default:M,Disabled:x,MinMax:V,Step:w,__namedExportsOrder:J,default:B},Symbol.toStringTag,{value:"Module"}));export{v as C,x as D,V as M,Y as R,w as S};
