import{j as r}from"./jsx-runtime-u17CrQMm.js";import{r as i,R as ue}from"./iframe-Bil5U4Xb.js";import{c as g}from"./index-uXKNKW_Z.js";import{T as ce}from"./Transition-Ccl5bNQr.js";import{I as Q}from"./Icon-DnLRKqDk.js";const de=({options:c=[],value:P,onChange:j,placeholder:T="Select an option",label:f,className:K,disabled:b=!1,defaultValue:X,searchable:V=!1,searchPlaceholder:z="Search...",filterOption:D,grouped:q=!1,native:Y=!1,id:Z,...B})=>{const ee=i.useId(),m=Z||ee,k=`wim-selectbox-label-${m}`,O=`wim-selectbox-list-${m}`,G=`wim-selectbox-trigger-${m}`,[l,v]=i.useState(!1),[ae,U]=i.useState(X||""),[x,y]=i.useState(""),[o,u]=i.useState(-1),$=i.useRef(null),C=i.useRef(null),E=i.useRef(null),N=i.useRef([]),F=P!==void 0,w=F?P:ae,I=i.useMemo(()=>q&&c.length>0&&"options"in c[0]?c.flatMap(a=>a.options):c,[c,q]),s=i.useMemo(()=>{if(!x)return I;const t=D||((e,d)=>e.type!=="separator"&&(e.label||"").toLowerCase().includes(d.toLowerCase()));return I.filter(e=>t(e,x))},[I,x,D]),R=I.find(a=>a.value===w);i.useEffect(()=>{const a=t=>{$.current&&!$.current.contains(t.target)&&(v(!1),y(""),u(-1))};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),i.useEffect(()=>{l&&V&&E.current&&E.current.focus()},[l,V]),i.useEffect(()=>{o>=0&&N.current[o]&&N.current[o]?.scrollIntoView({block:"nearest",behavior:"smooth"})},[o]);const re=()=>{b||(v(!l),l||(y(""),u(-1)))},L=a=>{a.type!=="separator"&&(a.disabled||(!F&&a.value!==void 0&&U(a.value),j&&a.value!==void 0&&j(a.value),v(!1),y(""),u(-1),C.current?.focus()))},W=a=>{if(!b)switch(a.key){case"Enter":case" ":l?o>=0&&s[o]&&L(s[o]):v(!0),a.preventDefault();break;case"Escape":v(!1),y(""),u(-1),C.current?.focus(),a.preventDefault();break;case"ArrowDown":a.preventDefault(),l?u(t=>{let e=t+1;for(e>=s.length&&(e=0);e<s.length&&(s[e]?.disabled||s[e]?.type==="separator");)e++;if(e>=s.length)for(e=0;e<t&&(s[e]?.disabled||s[e]?.type==="separator");)e++;return e<s.length?e:t}):v(!0);break;case"ArrowUp":a.preventDefault(),l&&u(t=>{let e=t-1;for(e<0&&(e=s.length-1);e>=0&&(s[e]?.disabled||s[e]?.type==="separator");)e--;if(e<0)for(e=s.length-1;e>t&&(s[e]?.disabled||s[e]?.type==="separator");)e--;return e>=0?e:t});break;case"Home":l&&(a.preventDefault(),u(0));break;case"End":l&&(a.preventDefault(),u(s.length-1));break}},te=()=>{let a=0;return q&&c.length>0&&"options"in c[0]?c.map((e,d)=>{const S=e.options.filter(n=>n.type==="separator"||!x||(D||((h,p)=>(h.label||"").toLowerCase().includes(p.toLowerCase())))(n,x));return S.length===0?null:r.jsxs(ue.Fragment,{children:[r.jsx("li",{className:"wim-selectbox-group-label",role:"presentation",children:e.label}),S.map((n,h)=>{const p=a++;if(n.type==="separator")return r.jsx("li",{className:"wim-selectbox-separator",role:"presentation"},`sep-${d}-${h}`);const ie=p===o,J=w===n.value,oe=`wim-selectbox-option-${m}-${n.value}`;return r.jsx("li",{id:oe,ref:M=>{N.current[p]=M},className:g("wim-selectbox-option",J&&"wim-selectbox-option--selected",n.disabled&&"wim-selectbox-option--disabled",ie&&"wim-selectbox-option--focused"),onClick:M=>{M.stopPropagation(),L(n)},onMouseEnter:()=>u(p),role:"option","aria-selected":J,"aria-disabled":n.disabled,children:n.label},n.value)})]},d)}):s.map((t,e)=>{const d=a++;if(t.type==="separator")return r.jsx("li",{className:"wim-selectbox-separator",role:"presentation"},`sep-${e}`);const S=d===o,n=w===t.value,h=`wim-selectbox-option-${m}-${t.value}`;return r.jsx("li",{id:h,ref:p=>{N.current[d]=p},className:g("wim-selectbox-option",n&&"wim-selectbox-option--selected",t.disabled&&"wim-selectbox-option--disabled",S&&"wim-selectbox-option--focused"),onClick:p=>{p.stopPropagation(),L(t)},onMouseEnter:()=>u(d),role:"option","aria-selected":n,"aria-disabled":t.disabled,children:t.label},t.value)})};if(Y)return r.jsxs("div",{className:g("wim-selectbox","wim-selectbox--native",K),children:[f&&r.jsx("label",{id:k,htmlFor:m,className:"wim-label",children:f}),r.jsxs("div",{className:"wim-selectbox-native-wrapper",children:[r.jsxs("select",{id:m,className:"wim-selectbox-select",value:w,disabled:b,onChange:a=>{j&&j(a.target.value),F||U(a.target.value)},...B,children:[!w&&r.jsx("option",{value:"",disabled:!0,children:T}),q?c.map((a,t)=>r.jsx("optgroup",{label:a.label,children:a.options.map((e,d)=>e.type==="separator"?r.jsx("hr",{},`hr-${t}-${d}`):r.jsx("option",{value:e.value,disabled:e.disabled,children:e.label},e.value))},t)):c.map((a,t)=>a.type==="separator"?r.jsx("hr",{},`hr-${t}`):r.jsx("option",{value:a.value,disabled:a.disabled,children:a.label},a.value))]}),r.jsx("div",{className:"wim-selectbox-icon",children:r.jsx(Q,{name:"ChevronDownIcon",size:"medium"})})]})]});const A=o>=0?s[o]:null,_=A&&A.type!=="separator"?`wim-selectbox-option-${m}-${A.value}`:void 0,{"aria-label":se,"aria-labelledby":H,"aria-describedby":le,...ne}=B;return r.jsxs("div",{className:g("wim-selectbox",K),ref:$,...ne,children:[f&&r.jsx("label",{id:k,htmlFor:G,className:"wim-label",children:f}),r.jsxs("div",{id:G,className:g("wim-selectbox-trigger",l&&"wim-selectbox-trigger--open",b&&"wim-selectbox-trigger--disabled"),onClick:re,onKeyDown:W,tabIndex:b?-1:0,role:"combobox","aria-expanded":l,"aria-haspopup":"listbox","aria-controls":l?O:void 0,"aria-disabled":b,"aria-labelledby":f?k:H,"aria-label":f?void 0:se||T,"aria-describedby":le,"aria-activedescendant":l?_:void 0,ref:C,children:[r.jsx("div",{className:g("wim-selectbox-value",!R&&"wim-selectbox-value--placeholder"),children:R?R.label:T}),r.jsx("div",{className:"wim-selectbox-icon",children:r.jsx(Q,{name:"ChevronDownIcon",size:"medium"})})]}),r.jsxs(ce,{show:l&&!b,enter:"fade-enter",enterFrom:"fade-enter-from",enterTo:"fade-enter-to",leave:"fade-leave",leaveFrom:"fade-leave-from",leaveTo:"fade-leave-to",className:"wim-selectbox-dropdown",children:[V&&r.jsx("div",{className:"wim-selectbox-search",children:r.jsx("input",{ref:E,type:"text",className:"wim-selectbox-search-input",placeholder:z,value:x,onChange:a=>{y(a.target.value),u(-1)},onClick:a=>a.stopPropagation(),onKeyDown:W,"aria-label":z,"aria-controls":O,"aria-activedescendant":_})}),r.jsx("ul",{id:O,className:"wim-selectbox-list",role:"listbox","aria-labelledby":f?k:H||void 0,children:s.length===0?r.jsx("li",{className:"wim-selectbox-empty",role:"option","aria-selected":"false",children:"No options found"}):te()})]})]})};de.__docgenInfo={description:"ユーザーが定義済みの選択肢から1つを選択するためのプルダウンメニュー。",methods:[],displayName:"Selectbox",props:{options:{required:!1,tsType:{name:"union",raw:"SelectboxOption[] | SelectboxOptionGroup[]",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label?: string;\r
    value?: string;\r
    disabled?: boolean;\r
    group?: string;\r
    type?: "option" | "separator";\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!1}},{key:"value",value:{name:"string",required:!1}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}},{key:"type",value:{name:"union",raw:'"option" | "separator"',elements:[{name:"literal",value:'"option"'},{name:"literal",value:'"separator"'}],required:!1}}]}}],raw:"SelectboxOption[]"},{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label: string;\r
    options: SelectboxOption[];\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label?: string;\r
    value?: string;\r
    disabled?: boolean;\r
    group?: string;\r
    type?: "option" | "separator";\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!1}},{key:"value",value:{name:"string",required:!1}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}},{key:"type",value:{name:"union",raw:'"option" | "separator"',elements:[{name:"literal",value:'"option"'},{name:"literal",value:'"separator"'}],required:!1}}]}}],raw:"SelectboxOption[]",required:!0}}]}}],raw:"SelectboxOptionGroup[]"}]},description:"",defaultValue:{value:"[]",computed:!1}},value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"Select an option"',computed:!1}},label:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},defaultValue:{required:!1,tsType:{name:"string"},description:""},searchable:{required:!1,tsType:{name:"boolean"},description:"Enable search/filtering functionality",defaultValue:{value:"false",computed:!1}},searchPlaceholder:{required:!1,tsType:{name:"string"},description:"Placeholder text for search input",defaultValue:{value:'"Search..."',computed:!1}},filterOption:{required:!1,tsType:{name:"signature",type:"function",raw:"(option: SelectboxOption, searchValue: string) => boolean",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{\r
    label?: string;\r
    value?: string;\r
    disabled?: boolean;\r
    group?: string;\r
    type?: "option" | "separator";\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!1}},{key:"value",value:{name:"string",required:!1}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}},{key:"type",value:{name:"union",raw:'"option" | "separator"',elements:[{name:"literal",value:'"option"'},{name:"literal",value:'"separator"'}],required:!1}}]}},name:"option"},{type:{name:"string"},name:"searchValue"}],return:{name:"boolean"}}},description:"Custom filter function"},grouped:{required:!1,tsType:{name:"boolean"},description:"Whether options are grouped",defaultValue:{value:"false",computed:!1}},native:{required:!1,tsType:{name:"boolean"},description:"Whether to use a native select element",defaultValue:{value:"false",computed:!1}},id:{required:!1,tsType:{name:"string"},description:"Unique ID for the component"}}};export{de as S};
