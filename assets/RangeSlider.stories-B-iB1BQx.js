import{j as f}from"./jsx-runtime-u17CrQMm.js";import{r as i}from"./iframe-BRQWL27F.js";import{c as z}from"./index-DWoaxWMs.js";const L=({value:g,defaultValue:D=[20,80],min:r=0,max:u=100,step:v=1,allowCross:m=!1,disabled:l=!1,onChange:b,onAfterChange:X,className:G,name:T,...H})=>{const d=g!==void 0,_=[Math.max(r,Math.min(D[0],u)),Math.max(r,Math.min(D[1],u))];_[0]>_[1]&&_.sort((e,n)=>e-n);const[R,E]=i.useState(_),s=d?g:R,j=i.useRef(null),p=i.useRef(null),C=(e,n,t)=>Math.max(n,Math.min(e,t)),U=e=>{const n=Math.round((e-r)/v);return C(r+n*v,r,u)},q=e=>{if(!j.current)return r;const n=j.current.getBoundingClientRect(),t=C((e-n.left)/n.width,0,1),a=r+t*(u-r);return U(a)},k=(e,n)=>{l||(p.current=n,e.stopPropagation(),e.preventDefault())},P=e=>{if(l)return;const n="touches"in e?e.touches[0].clientX:e.clientX,t=q(n),a=Math.abs(s[0]-t),o=Math.abs(s[1]-t);let c;a<o?c="min":o<a?c="max":c=t<s[0]?"min":"max",p.current=c,$(t,c)},$=(e,n)=>{let t=[...s];if(n==="min"){const a=m?u:t[1];t[0]=Math.min(e,a)}else{const a=m?r:t[0];t[1]=Math.max(e,a)}d||E(t),b?.(t)};i.useCallback(e=>{if(!p.current||l)return;const n="touches"in e?e.touches[0].clientX:e.clientX,t=q(n);$(t,p.current)},[l,d,r,u,v,b,s,m]);const A=i.useRef(s);i.useEffect(()=>{A.current=s},[s]);const y=i.useCallback(e=>{if(!p.current||l)return;const n="touches"in e?e.touches[0].clientX:e.clientX,t=q(n);let a=[...A.current];if(p.current==="min"){const o=m?u:a[1];a[0]=Math.min(t,o)}else{const o=m?r:a[0];a[1]=Math.max(t,o)}d||E(a),b?.(a)},[l,d,r,u,v,b,m]),M=i.useCallback(()=>{p.current&&(p.current=null,X?.(d?g:R))},[d,g,R,X]);i.useEffect(()=>(document.addEventListener("mousemove",y),document.addEventListener("mouseup",M),document.addEventListener("touchmove",y,{passive:!1}),document.addEventListener("touchend",M),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",M),document.removeEventListener("touchmove",y),document.removeEventListener("touchend",M)}),[y,M]);const I=(e,n)=>{if(l)return;let t=[...s];const a=n==="min"?t[0]:t[1];let o=a;if(e.key==="ArrowLeft"||e.key==="ArrowDown")o=Math.max(r,a-v);else if(e.key==="ArrowRight"||e.key==="ArrowUp")o=Math.min(u,a+v);else if(e.key==="Home")o=r;else if(e.key==="End")o=u;else return;if(n==="min"){const c=m?u:t[1];t[0]=Math.min(o,c)}else{const c=m?r:t[0];t[1]=Math.max(o,c)}d||E(t),b?.(t),e.preventDefault()},O=e=>(e-r)/(u-r)*100,N=O(s[0]),K=O(s[1]);return f.jsxs("div",{className:z("wim-range-slider",l&&"wim-range-slider--disabled",G),onMouseDown:P,onTouchStart:P,...H,children:[f.jsxs("div",{className:"wim-range-slider__track-container",ref:j,children:[f.jsx("div",{className:"wim-range-slider__track",style:{left:`${N}%`,width:`${K-N}%`}}),f.jsx("div",{className:"wim-range-slider__thumb",style:{left:`${N}%`},role:"slider","aria-valuemin":r,"aria-valuemax":s[1],"aria-valuenow":s[0],"aria-disabled":l,tabIndex:l?-1:0,onMouseDown:e=>k(e,"min"),onTouchStart:e=>k(e,"min"),onKeyDown:e=>I(e,"min")}),f.jsx("div",{className:"wim-range-slider__thumb",style:{left:`${K}%`},role:"slider","aria-valuemin":s[0],"aria-valuemax":u,"aria-valuenow":s[1],"aria-disabled":l,tabIndex:l?-1:0,onMouseDown:e=>k(e,"max"),onTouchStart:e=>k(e,"max"),onKeyDown:e=>I(e,"max")})]}),f.jsx("input",{type:"hidden",name:T?`${T}-min`:"",value:s[0]}),f.jsx("input",{type:"hidden",name:T?`${T}-max`:"",value:s[1]})]})};L.__docgenInfo={description:"範囲（開始と終了）を選択するためのスライダーコンポーネント。",methods:[],displayName:"RangeSlider",props:{value:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:"現在の値 [min, max]"},defaultValue:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:"デフォルトの値 [min, max]（非制御時）",defaultValue:{value:"[20, 80]",computed:!1}},min:{required:!1,tsType:{name:"number"},description:"最小値",defaultValue:{value:"0",computed:!1}},max:{required:!1,tsType:{name:"number"},description:"最大値",defaultValue:{value:"100",computed:!1}},step:{required:!1,tsType:{name:"number"},description:"ステップ値",defaultValue:{value:"1",computed:!1}},allowCross:{required:!1,tsType:{name:"boolean"},description:"同じ値を許容するかどうか（交差はしない）",defaultValue:{value:"false",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:"無効化フラグ",defaultValue:{value:"false",computed:!1}},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: [number, number]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"value"}],return:{name:"void"}}},description:"値変更時のコールバック"},onAfterChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: [number, number]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"value"}],return:{name:"void"}}},description:"ドラッグ終了時のコールバック"},className:{required:!1,tsType:{name:"string"},description:"追加のクラス名"},name:{required:!1,tsType:{name:"string"},description:`名前の属性。フォーム送信時には name-min と name-max として送信されることを想定するか、\r
あるいはJSON文字列として送信するかなど検討が必要だが、ここでは隠しinputを2つつくる。`}}};const B={title:"Component/Pickers & Sliders/RangeSlider",component:L,argTypes:{onChange:{action:"changed"},onAfterChange:{action:"afterChanged"}}},x={args:{defaultValue:[20,80]}},V={args:{defaultValue:[30,70],disabled:!0}},w={args:{min:-50,max:50,defaultValue:[-20,20]}},S={args:{min:0,max:100,step:10,defaultValue:[20,90]}},h=()=>{const[g,D]=i.useState([20,50]);return f.jsx(L,{value:g,onChange:D})};h.__docgenInfo={description:"",methods:[],displayName:"Controlled"};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:`{
  args: {
    defaultValue: [20, 80]
  }
}`,...x.parameters?.docs?.source}}};V.parameters={...V.parameters,docs:{...V.parameters?.docs,source:{originalSource:`{
  args: {
    defaultValue: [30, 70],
    disabled: true
  }
}`,...V.parameters?.docs?.source}}};w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:`{
  args: {
    min: -50,
    max: 50,
    defaultValue: [-20, 20]
  }
}`,...w.parameters?.docs?.source}}};S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:`{
  args: {
    min: 0,
    max: 100,
    step: 10,
    defaultValue: [20, 90]
  }
}`,...S.parameters?.docs?.source}}};h.parameters={...h.parameters,docs:{...h.parameters?.docs,source:{originalSource:`() => {
  const [val, setVal] = useState<[number, number]>([20, 50]);
  return <RangeSlider value={val} onChange={setVal} />;
}`,...h.parameters?.docs?.source}}};const J=["Default","Disabled","MinMax","Step","Controlled"],Y=Object.freeze(Object.defineProperty({__proto__:null,Controlled:h,Default:x,Disabled:V,MinMax:w,Step:S,__namedExportsOrder:J,default:B},Symbol.toStringTag,{value:"Module"}));export{h as C,V as D,w as M,Y as R,S};
