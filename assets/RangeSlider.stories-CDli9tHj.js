import{j as c}from"./jsx-runtime-u17CrQMm.js";import{r as u}from"./iframe-B3BjqrJG.js";import{c as z}from"./index-C7GNrL9d.js";const $=({value:g,defaultValue:D=[20,80],min:t=0,max:l=100,step:h=1,allowCross:p=!1,disabled:i=!1,onChange:T,onAfterChange:P,className:J,name:k,label:d,id:F,...Q})=>{const f=g!==void 0,W=u.useId(),j=`wim-range-slider-label-${F||W}`,_=[Math.max(t,Math.min(D[0],l)),Math.max(t,Math.min(D[1],l))];_[0]>_[1]&&_.sort((e,n)=>e-n);const[q,N]=u.useState(_),s=f?g:q,L=u.useRef(null),v=u.useRef(null),E=u.useCallback((e,n,a)=>Math.max(n,Math.min(e,a)),[]),X=u.useCallback(e=>{const n=Math.round((e-t)/h);return E(t+n*h,t,l)},[E,t,l,h]),C=u.useCallback(e=>{if(!L.current)return t;const n=L.current.getBoundingClientRect(),a=E((e-n.left)/n.width,0,1),r=t+a*(l-t);return X(r)},[X,E,l,t]),R=(e,n)=>{i||(v.current=n,e.stopPropagation(),e.preventDefault())},A=e=>{if(i)return;const n="touches"in e?e.touches[0].clientX:e.clientX,a=C(n),r=Math.abs(s[0]-a),o=Math.abs(s[1]-a);let m;r<o?m="min":o<r?m="max":m=a<s[0]?"min":"max",v.current=m,Y(a,m)},Y=(e,n)=>{let a=[...s];if(n==="min"){const r=p?l:a[1];a[0]=Math.min(e,r)}else{const r=p?t:a[0];a[1]=Math.max(e,r)}f||N(a),T?.(a)},O=u.useRef(s);u.useEffect(()=>{O.current=s},[s]);const y=u.useCallback(e=>{if(!v.current||i)return;const n="touches"in e?e.touches[0].clientX:e.clientX,a=C(n);let r=[...O.current];if(v.current==="min"){const o=p?l:r[1];r[0]=Math.min(a,o)}else{const o=p?t:r[0];r[1]=Math.max(a,o)}f||N(r),T?.(r)},[i,f,T,p,C,t,l]),x=u.useCallback(()=>{v.current&&(v.current=null,P?.(f?g:q))},[f,g,q,P]);u.useEffect(()=>(document.addEventListener("mousemove",y),document.addEventListener("mouseup",x),document.addEventListener("touchmove",y,{passive:!1}),document.addEventListener("touchend",x),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",x),document.removeEventListener("touchmove",y),document.removeEventListener("touchend",x)}),[y,x]);const B=(e,n)=>{if(i)return;let a=[...s];const r=n==="min"?a[0]:a[1];let o=r;if(e.key==="ArrowLeft"||e.key==="ArrowDown")o=Math.max(t,r-h);else if(e.key==="ArrowRight"||e.key==="ArrowUp")o=Math.min(l,r+h);else if(e.key==="Home")o=t;else if(e.key==="End")o=l;else return;if(n==="min"){const m=p?l:a[1];a[0]=Math.min(o,m)}else{const m=p?t:a[0];a[1]=Math.max(o,m)}f||N(a),T?.(a),e.preventDefault()},K=e=>(e-t)/(l-t)*100,I=K(s[0]),G=K(s[1]),{"aria-label":H,"aria-labelledby":U,...Z}=Q;return c.jsxs("div",{className:z("wim-range-slider-container",J),children:[d&&c.jsx("span",{id:j,className:"wim-label",style:{display:"block",marginBottom:"8px"},children:d}),c.jsxs("div",{className:z("wim-range-slider",i&&"wim-range-slider--disabled"),onMouseDown:A,onTouchStart:A,...Z,children:[c.jsxs("div",{className:"wim-range-slider__track-container",ref:L,children:[c.jsx("div",{className:"wim-range-slider__track",style:{left:`${I}%`,width:`${G-I}%`}}),c.jsx("div",{className:"wim-range-slider__thumb",style:{left:`${I}%`},role:"slider","aria-valuemin":t,"aria-valuemax":s[1],"aria-valuenow":s[0],"aria-disabled":i,"aria-labelledby":d?j:U,"aria-label":d?`Start ${d}`:H||"Start",tabIndex:i?-1:0,onMouseDown:e=>R(e,"min"),onTouchStart:e=>R(e,"min"),onKeyDown:e=>B(e,"min")}),c.jsx("div",{className:"wim-range-slider__thumb",style:{left:`${G}%`},role:"slider","aria-valuemin":s[0],"aria-valuemax":l,"aria-valuenow":s[1],"aria-disabled":i,"aria-labelledby":d?j:U,"aria-label":d?`End ${d}`:H||"End",tabIndex:i?-1:0,onMouseDown:e=>R(e,"max"),onTouchStart:e=>R(e,"max"),onKeyDown:e=>B(e,"max")})]}),c.jsx("input",{type:"hidden",name:k?`${k}-min`:"",value:s[0]}),c.jsx("input",{type:"hidden",name:k?`${k}-max`:"",value:s[1]})]})]})};$.__docgenInfo={description:"範囲（開始と終了）を選択するためのスライダーコンポーネント。",methods:[],displayName:"RangeSlider",props:{value:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:"現在の値 [min, max]"},defaultValue:{required:!1,tsType:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},description:"デフォルトの値 [min, max]（非制御時）",defaultValue:{value:"[20, 80]",computed:!1}},min:{required:!1,tsType:{name:"number"},description:"最小値",defaultValue:{value:"0",computed:!1}},max:{required:!1,tsType:{name:"number"},description:"最大値",defaultValue:{value:"100",computed:!1}},step:{required:!1,tsType:{name:"number"},description:"ステップ値",defaultValue:{value:"1",computed:!1}},allowCross:{required:!1,tsType:{name:"boolean"},description:"同じ値を許容するかどうか（交差はしない）",defaultValue:{value:"false",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:"無効化フラグ",defaultValue:{value:"false",computed:!1}},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: [number, number]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"value"}],return:{name:"void"}}},description:"値変更時のコールバック"},onAfterChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: [number, number]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number]",elements:[{name:"number"},{name:"number"}]},name:"value"}],return:{name:"void"}}},description:"ドラッグ終了時のコールバック"},className:{required:!1,tsType:{name:"string"},description:"追加のクラス名"},name:{required:!1,tsType:{name:"string"},description:`名前の属性。フォーム送信時には name-min と name-max として送信されることを想定するか、\r
あるいはJSON文字列として送信するかなど検討が必要だが、ここでは隠しinputを2つつくる。`},label:{required:!1,tsType:{name:"string"},description:"アクセシビリティ用のラベル"},id:{required:!1,tsType:{name:"string"},description:"カスタムID"}}};const ee={title:"Component/Pickers & Sliders/RangeSlider",component:$,argTypes:{onChange:{action:"changed"},onAfterChange:{action:"afterChanged"}}},M={args:{defaultValue:[20,80]}},V={args:{defaultValue:[30,70],disabled:!0}},w={args:{min:-50,max:50,defaultValue:[-20,20]}},S={args:{min:0,max:100,step:10,defaultValue:[20,90]}},b=()=>{const[g,D]=u.useState([20,50]);return c.jsx($,{value:g,onChange:D})};b.__docgenInfo={description:"",methods:[],displayName:"Controlled"};M.parameters={...M.parameters,docs:{...M.parameters?.docs,source:{originalSource:`{
  args: {
    defaultValue: [20, 80]
  }
}`,...M.parameters?.docs?.source}}};V.parameters={...V.parameters,docs:{...V.parameters?.docs,source:{originalSource:`{
  args: {
    defaultValue: [30, 70],
    disabled: true
  }
}`,...V.parameters?.docs?.source}}};w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:`{
  args: {
    min: -50,
    max: 50,
    defaultValue: [-20, 20]
  }
}`,...w.parameters?.docs?.source}}};S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:`{
  args: {
    min: 0,
    max: 100,
    step: 10,
    defaultValue: [20, 90]
  }
}`,...S.parameters?.docs?.source}}};b.parameters={...b.parameters,docs:{...b.parameters?.docs,source:{originalSource:`() => {
  const [val, setVal] = useState<[number, number]>([20, 50]);
  return <RangeSlider value={val} onChange={setVal} />;
}`,...b.parameters?.docs?.source}}};const ae=["Default","Disabled","MinMax","Step","Controlled"],le=Object.freeze(Object.defineProperty({__proto__:null,Controlled:b,Default:M,Disabled:V,MinMax:w,Step:S,__namedExportsOrder:ae,default:ee},Symbol.toStringTag,{value:"Module"}));export{b as C,V as D,w as M,le as R,S};
