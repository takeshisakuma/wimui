import{j as n}from"./jsx-runtime-u17CrQMm.js";import{r as o,R as Z}from"./iframe-CS53r1Jw.js";import{P as a}from"./index-C4YrDqfR.js";import{I as ee}from"./Icon-B15kVuyW.js";const F=({options:d=[],value:L,onChange:_,placeholder:z="Select an option",label:M,className:G="",disabled:m=!1,defaultValue:H,searchable:j=!1,searchPlaceholder:U="Search...",filterOption:V,grouped:C=!1,...B})=>{const[i,f]=o.useState(!1),[J,Q]=o.useState(H||""),[b,h]=o.useState(""),[c,u]=o.useState(-1),R=o.useRef(null),T=o.useRef(null),D=o.useRef(null),S=o.useRef([]),A=L!==void 0,N=A?L:J,O=o.useMemo(()=>C&&d.length>0&&"options"in d[0]?d.flatMap(e=>e.options):d,[d,C]),l=o.useMemo(()=>{if(!b)return O;const s=V||((t,r)=>t.label.toLowerCase().includes(r.toLowerCase()));return O.filter(t=>s(t,b))},[O,b,V]),E=O.find(e=>e.value===N);o.useEffect(()=>{const e=s=>{R.current&&!R.current.contains(s.target)&&(f(!1),h(""),u(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),o.useEffect(()=>{i&&j&&D.current&&D.current.focus()},[i,j]),o.useEffect(()=>{c>=0&&S.current[c]&&S.current[c]?.scrollIntoView({block:"nearest",behavior:"smooth"})},[c]);const X=()=>{m||(f(!i),i||(h(""),u(-1)))},I=e=>{e.disabled||(A||Q(e.value),_&&_(e.value),f(!1),h(""),u(-1),T.current?.focus())},W=e=>{if(!m)switch(e.key){case"Enter":case" ":i?c>=0&&l[c]&&I(l[c]):f(!0),e.preventDefault();break;case"Escape":f(!1),h(""),u(-1),T.current?.focus(),e.preventDefault();break;case"ArrowDown":e.preventDefault(),i?u(s=>{const t=s+1;if(t>=l.length)return 0;if(l[t]?.disabled){let r=t+1;for(;r<l.length&&l[r]?.disabled;)r++;return r<l.length?r:s}return t}):f(!0);break;case"ArrowUp":e.preventDefault(),i&&u(s=>{if(s<=0)return l.length-1;const t=s-1;if(l[t]?.disabled){let r=t-1;for(;r>=0&&l[r]?.disabled;)r--;return r>=0?r:s}return t});break;case"Home":i&&(e.preventDefault(),u(0));break;case"End":i&&(e.preventDefault(),u(l.length-1));break}},Y=()=>{if(C&&d.length>0&&"options"in d[0]){const e=d;let s=0;return e.map((t,r)=>{const g=t.options.filter(p=>!b||(V||((v,P)=>v.label.toLowerCase().includes(P.toLowerCase())))(p,b));return g.length===0?null:n.jsxs(Z.Fragment,{children:[n.jsx("li",{className:"wim-selectbox-group-label",role:"presentation",children:t.label}),g.map(p=>{const v=s++,P=v===c,K=N===p.value;return n.jsx("li",{ref:$=>{S.current[v]=$},className:`wim-selectbox-option ${K?"wim-selectbox-option--selected":""} ${p.disabled?"wim-selectbox-option--disabled":""} ${P?"wim-selectbox-option--focused":""}`,onClick:$=>{$.stopPropagation(),I(p)},onMouseEnter:()=>u(v),role:"option","aria-selected":K,"aria-disabled":p.disabled,children:p.label},p.value)})]},r)})}return l.map((e,s)=>{const t=s===c,r=N===e.value;return n.jsx("li",{ref:g=>{S.current[s]=g},className:`wim-selectbox-option ${r?"wim-selectbox-option--selected":""} ${e.disabled?"wim-selectbox-option--disabled":""} ${t?"wim-selectbox-option--focused":""}`,onClick:g=>{g.stopPropagation(),I(e)},onMouseEnter:()=>u(s),role:"option","aria-selected":r,"aria-disabled":e.disabled,children:e.label},e.value)})};return n.jsxs("div",{className:`wim-selectbox ${G}`,ref:R,...B,children:[M&&n.jsx("label",{className:"wim-label",children:M}),n.jsxs("div",{className:`wim-selectbox-trigger ${i?"wim-selectbox-trigger--open":""} ${m?"wim-selectbox-trigger--disabled":""}`,onClick:X,onKeyDown:W,tabIndex:m?-1:0,role:"combobox","aria-expanded":i,"aria-haspopup":"listbox","aria-disabled":m,ref:T,children:[n.jsx("div",{className:`wim-selectbox-value ${E?"":"wim-selectbox-value--placeholder"}`,children:E?E.label:z}),n.jsx("div",{className:"wim-selectbox-icon",children:n.jsx(ee,{name:"ChevronDownIcon",size:"medium"})})]}),i&&!m&&n.jsxs("div",{className:"wim-selectbox-dropdown",children:[j&&n.jsx("div",{className:"wim-selectbox-search",children:n.jsx("input",{ref:D,type:"text",className:"wim-selectbox-search-input",placeholder:U,value:b,onChange:e=>{h(e.target.value),u(-1)},onClick:e=>e.stopPropagation(),onKeyDown:W})}),n.jsx("ul",{className:"wim-selectbox-list",role:"listbox",children:l.length===0?n.jsx("li",{className:"wim-selectbox-empty",children:"No options found"}):Y()})]})]})};F.propTypes={options:a.arrayOf(a.oneOfType([a.shape({label:a.string.isRequired,value:a.string.isRequired,disabled:a.bool,group:a.string}),a.shape({label:a.string.isRequired,options:a.arrayOf(a.shape({label:a.string.isRequired,value:a.string.isRequired,disabled:a.bool})).isRequired})])).isRequired,value:a.string,onChange:a.func,placeholder:a.string,label:a.string,className:a.string,disabled:a.bool,defaultValue:a.string,searchable:a.bool,searchPlaceholder:a.string,filterOption:a.func,grouped:a.bool};F.__docgenInfo={description:"ユーザーが定義済みの選択肢から1つを選択するためのプルダウンメニュー。",methods:[],displayName:"Selectbox",props:{options:{required:!1,tsType:{name:"union",raw:"SelectboxOption[] | SelectboxOptionGroup[]",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label: string;\r
    value: string;\r
    disabled?: boolean;\r
    group?: string;\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}}]}}],raw:"SelectboxOption[]"},{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label: string;\r
    options: SelectboxOption[];\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label: string;\r
    value: string;\r
    disabled?: boolean;\r
    group?: string;\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}}]}}],raw:"SelectboxOption[]",required:!0}}]}}],raw:"SelectboxOptionGroup[]"}]},description:"選択肢の配列。",defaultValue:{value:"[]",computed:!1},type:{name:"arrayOf",value:{name:"union",value:[{name:"shape",value:{label:{name:"string",required:!0},value:{name:"string",required:!0},disabled:{name:"bool",required:!1},group:{name:"string",required:!1}}},{name:"shape",value:{label:{name:"string",required:!0},options:{name:"arrayOf",value:{name:"shape",value:{label:{name:"string",required:!0},value:{name:"string",required:!0},disabled:{name:"bool",required:!1}}},required:!0}}}]}}},value:{required:!1,tsType:{name:"string"},description:"現在の値 (制御されたコンポーネントの場合)。",type:{name:"string"}},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:"値が変更された時のコールバック。",type:{name:"func"}},placeholder:{required:!1,tsType:{name:"string"},description:"プレースホルダー。",defaultValue:{value:'"Select an option"',computed:!1},type:{name:"string"}},label:{required:!1,tsType:{name:"string"},description:"ラベル。",type:{name:"string"}},className:{required:!1,tsType:{name:"string"},description:"追加のクラス名。",defaultValue:{value:'""',computed:!1},type:{name:"string"}},disabled:{required:!1,tsType:{name:"boolean"},description:"無効化。",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},defaultValue:{required:!1,tsType:{name:"string"},description:"初期値 (非制御コンポーネントの場合)。",type:{name:"string"}},searchable:{required:!1,tsType:{name:"boolean"},description:"Enable search/filtering functionality",defaultValue:{value:"false",computed:!1},type:{name:"bool"}},searchPlaceholder:{required:!1,tsType:{name:"string"},description:"Placeholder text for search input",defaultValue:{value:'"Search..."',computed:!1},type:{name:"string"}},filterOption:{required:!1,tsType:{name:"signature",type:"function",raw:"(option: SelectboxOption, searchValue: string) => boolean",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{\r
    label: string;\r
    value: string;\r
    disabled?: boolean;\r
    group?: string;\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}}]}},name:"option"},{type:{name:"string"},name:"searchValue"}],return:{name:"boolean"}}},description:"Custom filter function",type:{name:"func"}},grouped:{required:!1,tsType:{name:"boolean"},description:"Whether options are grouped",defaultValue:{value:"false",computed:!1},type:{name:"bool"}}}};const ae={title:"Component/Selection Controls/Selectbox",component:F,parameters:{layout:"centered",docs:{description:{component:"ユーザーが定義済みの選択肢から1つを選択するためのコンポーネント。"}}},tags:[],argTypes:{onChange:{action:"changed"}}},k=[{label:"Option 1",value:"opt1"},{label:"Option 2",value:"opt2"},{label:"Option 3",value:"opt3"},{label:"Disabled Option",value:"opt4",disabled:!0},{label:"Option 5",value:"opt5"}],y={args:{options:k,placeholder:"Select an option..."}},x={args:{label:"Choose an item",options:k,placeholder:"Select..."}},w={args:{options:k,defaultValue:"opt2"}},q={args:{options:k,disabled:!0,defaultValue:"opt1"}};y.parameters={...y.parameters,docs:{...y.parameters?.docs,source:{originalSource:`{
  args: {
    options: options,
    placeholder: "Select an option..."
  }
}`,...y.parameters?.docs?.source}}};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:`{
  args: {
    label: "Choose an item",
    options: options,
    placeholder: "Select..."
  }
}`,...x.parameters?.docs?.source}}};w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:`{
  args: {
    options: options,
    defaultValue: "opt2"
  }
}`,...w.parameters?.docs?.source}}};q.parameters={...q.parameters,docs:{...q.parameters?.docs,source:{originalSource:`{
  args: {
    options: options,
    disabled: true,
    defaultValue: "opt1"
  }
}`,...q.parameters?.docs?.source}}};const re=["Default","WithLabel","Preselected","Disabled"],oe=Object.freeze(Object.defineProperty({__proto__:null,Default:y,Disabled:q,Preselected:w,WithLabel:x,__namedExportsOrder:re,default:ae},Symbol.toStringTag,{value:"Module"}));export{y as D,w as P,oe as S,x as W,q as a};
