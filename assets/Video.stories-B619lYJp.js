import{j as t}from"./jsx-runtime-u17CrQMm.js";import{R as i}from"./iframe-CxGJGCEe.js";import{c as ae}from"./index-kCw4ylN7.js";import{I as r}from"./Icon-CBegJE_x.js";const re=({src:ie,width:Re,height:oe,autoPlay:L=!1,loop:M=!1,muted:B=!1,controls:le=!0,poster:K,radius:W="none",shadow:ce=!1,border:ue=!1,fit:me="cover",preload:de,caption:G,className:pe,style:fe,customControls:w=!1,advancedControls:o=!1,videoId:u,resumePlayback:q=!1,playlist:a,autoPlayNext:ve=!1,qualities:p,...he})=>{const s=i.useRef(null),y=i.useRef(null),[k,z]=i.useState(!1),[D,E]=i.useState(0),[f,ge]=i.useState(0),[v,$]=i.useState(1),[b,_]=i.useState(B),[H,A]=i.useState(!1),[x,we]=i.useState(1),[P,be]=i.useState(me),[c,U]=i.useState(0),[N,xe]=i.useState(0),[d,l]=i.useState(null),J=p&&p.length>0?p[N].src:a&&a.length>0?a[c].src:ie,je=a&&a.length>0&&a[c].poster||K;i.useEffect(()=>{if(u&&q&&s.current){const e=a&&a.length>0?`${u}-${c}`:u,n=localStorage.getItem(`wimui-video-resume-${e}`);n&&(s.current.currentTime=parseFloat(n),E(parseFloat(n)))}},[u,q,c,a]),i.useEffect(()=>{L&&s.current&&s.current.play().catch(e=>{console.warn("Autoplay was prevented:",e)})},[L,J]),i.useEffect(()=>{s.current&&(s.current.volume=v,s.current.muted=b,s.current.playbackRate=x,s.current.loop=M&&(!a||a.length<=1))},[v,b,x,M,a]);const ye=e=>{if(!s.current)return;const n=s.current.currentTime,h=!s.current.paused;xe(e),setTimeout(()=>{s.current&&(s.current.currentTime=n,h&&s.current.play())},50),l("main")},O=()=>{s.current&&(k?s.current.pause():s.current.play(),z(!k))},ke=()=>{if(s.current){const e=s.current.currentTime;if(E(e),u&&q&&Math.floor(e)%5===0&&f>0&&e<f-2){const n=a&&a.length>0?`${u}-${c}`:u;localStorage.setItem(`wimui-video-resume-${n}`,e.toString())}}},Pe=()=>{s.current&&ge(s.current.duration)},Ne=()=>{if(u&&q){const e=a&&a.length>0?`${u}-${c}`:u;localStorage.removeItem(`wimui-video-resume-${e}`)}a&&a.length>0&&ve&&c<a.length-1?(U(e=>e+1),s.current&&setTimeout(()=>{s.current?.play()},100)):z(!1)},Ce=e=>{const n=parseFloat(e.target.value);s.current&&(s.current.currentTime=n,E(n))},Te=e=>{const n=parseFloat(e.target.value);$(n),n>0&&_(!1)},Y=()=>{_(!b)},Z=()=>{y.current&&(document.fullscreenElement?(document.exitFullscreen(),A(!1)):(y.current.requestFullscreen().catch(e=>{console.warn(`Error attempting to enable fullscreen mode: ${e.message} (${e.name})`)}),A(!0)))};i.useEffect(()=>{const e=()=>{A(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[]);const ee=e=>{const n=Math.floor(e/60),h=Math.floor(e%60);return`${n}:${h.toString().padStart(2,"0")}`},j=e=>{if(s.current){const n=Math.max(0,Math.min(s.current.currentTime+e,f));s.current.currentTime=n,E(n)}},te=async()=>{if(s.current)try{document.pictureInPictureElement?await document.exitPictureInPicture():document.pictureInPictureEnabled&&await s.current.requestPictureInPicture()}catch(e){console.error("Failed to toggle PiP mode:",e)}};i.useEffect(()=>{const e=n=>{if(!(["INPUT","TEXTAREA","SELECT"].includes(n.target.tagName)||!(w||o)||!(y.current?.contains(document.activeElement)||document.fullscreenElement===y.current)&&document.activeElement!==document.body))switch(n.key.toLowerCase()){case" ":case"k":n.preventDefault(),O();break;case"arrowright":n.preventDefault(),j(10);break;case"arrowleft":n.preventDefault(),j(-10);break;case"arrowup":n.preventDefault();const C=Math.min(1,v+.1);$(C),C>0&&_(!1);break;case"arrowdown":n.preventDefault();const X=Math.max(0,v-.1);$(X);break;case"m":n.preventDefault(),Y();break;case"f":n.preventDefault(),Z();break;case"p":n.preventDefault(),te();break}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[k,v,f,w,o]);const[ne,se]=i.useState(null),[R,Q]=i.useState({show:!1,direction:"forward"}),Ie=e=>{if(!w&&!o)return;const n=new Date().getTime(),h=e.currentTarget.getBoundingClientRect(),C=e.clientX-h.left,X=h.width;ne&&n-ne.time<300?(C>X/2?(j(10),Q({show:!0,direction:"forward"})):(j(-10),Q({show:!0,direction:"backward"})),setTimeout(()=>Q({show:!1,direction:"forward"}),600),se(null)):(se({time:n,x:C}),setTimeout(()=>{Date.now()-n>=290&&O()},300))},Se={width:"100%",height:oe||"auto",objectFit:P,...fe},Ve=w||o?!1:le,Fe=[.25,.5,.75,1,1.25,1.5,1.75,2],qe=["contain","cover","fill","scale-down","none"];return t.jsxs("figure",{className:ae("wim-video-container",pe),style:{width:"100%"},children:[t.jsxs("div",{className:ae("wim-video-inner",W!=="none"&&`wim-video--radius-${W}`,ce&&"wim-video--shadow",ue&&"wim-video--border",(w||o)&&"wim-video--custom"),ref:y,children:[t.jsx("video",{ref:s,src:J,className:"wim-video",style:Se,autoPlay:L,loop:M&&(!a||a.length<=1),muted:B,controls:Ve,poster:je,preload:de,playsInline:!0,onTimeUpdate:ke,onLoadedMetadata:Pe,onEnded:Ne,onPlay:()=>z(!0),onPause:()=>z(!1),onClick:Ie,...he}),R.show&&t.jsxs("div",{className:"wim-video-skip-indicator",children:[t.jsx(r,{name:R.direction==="forward"?"ChevronRightIcon":"ChevronLeftIcon",size:"large"}),t.jsx(r,{name:R.direction==="forward"?"ChevronRightIcon":"ChevronLeftIcon",size:"large"}),t.jsx(r,{name:R.direction==="forward"?"ChevronRightIcon":"ChevronLeftIcon",size:"large"}),t.jsx("span",{children:"10秒"})]}),(w||o)&&t.jsxs("div",{className:"wim-video-custom-controls",onClick:()=>d&&l(null),children:[o&&d==="main"&&t.jsxs("div",{className:"wim-video-advanced-menu",onClick:e=>e.stopPropagation(),children:[t.jsx("div",{className:"wim-video-menu-title",children:t.jsx("span",{children:"設定"})}),t.jsxs("div",{className:"wim-video-menu-items",children:[p&&p.length>0&&t.jsxs("button",{className:"wim-video-menu-btn",onClick:()=>l("quality"),children:[t.jsx("span",{children:"画質"}),t.jsxs("span",{style:{opacity:.7},children:[p[N].label," ",t.jsx(r,{name:"ChevronRightIcon",size:"small"})]})]}),t.jsxs("button",{className:"wim-video-menu-btn",onClick:()=>l("rate"),children:[t.jsx("span",{children:"再生速度"}),t.jsxs("span",{style:{opacity:.7},children:[x,"x"," ",t.jsx(r,{name:"ChevronRightIcon",size:"small"})]})]}),t.jsxs("button",{className:"wim-video-menu-btn",onClick:()=>l("fit"),children:[t.jsx("span",{children:"アスペクト比"}),t.jsxs("span",{style:{opacity:.7},children:[P," ",t.jsx(r,{name:"ChevronRightIcon",size:"small"})]})]})]})]}),o&&d==="quality"&&t.jsxs("div",{className:"wim-video-advanced-menu",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"wim-video-menu-title",children:[t.jsx("button",{onClick:()=>l("main"),className:"wim-video-btn",children:t.jsx(r,{name:"ChevronLeftIcon",size:"small"})}),t.jsx("span",{children:"画質"})]}),t.jsx("div",{className:"wim-video-menu-items",children:p?.map((e,n)=>t.jsxs("button",{className:"wim-video-menu-btn","data-active":N===n,onClick:()=>ye(n),children:[N===n&&t.jsx(r,{name:"CheckIcon",size:"small"}),t.jsx("span",{style:{marginLeft:N===n?0:24},children:e.label})]},n))})]}),o&&d==="rate"&&t.jsxs("div",{className:"wim-video-advanced-menu",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"wim-video-menu-title",children:[t.jsx("button",{onClick:()=>l("main"),className:"wim-video-btn",children:t.jsx(r,{name:"ChevronLeftIcon",size:"small"})}),t.jsx("span",{children:"再生速度"})]}),t.jsx("div",{className:"wim-video-menu-items",children:Fe.map(e=>t.jsxs("button",{className:"wim-video-menu-btn","data-active":x===e,onClick:()=>{we(e),l("main")},children:[x===e&&t.jsx(r,{name:"CheckIcon",size:"small"}),t.jsx("span",{style:{marginLeft:x===e?0:24},children:e===1?"標準":`${e}x`})]},e))})]}),o&&d==="fit"&&t.jsxs("div",{className:"wim-video-advanced-menu",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"wim-video-menu-title",children:[t.jsx("button",{onClick:()=>l("main"),className:"wim-video-btn",children:t.jsx(r,{name:"ChevronLeftIcon",size:"small"})}),t.jsx("span",{children:"アスペクト比"})]}),t.jsx("div",{className:"wim-video-menu-items",children:qe.map(e=>t.jsxs("button",{className:"wim-video-menu-btn","data-active":P===e,onClick:()=>{be(e),l("main")},children:[P===e&&t.jsx(r,{name:"CheckIcon",size:"small"}),t.jsx("span",{style:{marginLeft:P===e?0:24},children:e})]},e))})]}),o&&d==="playlist"&&t.jsxs("div",{className:"wim-video-advanced-menu",onClick:e=>e.stopPropagation(),style:{bottom:60,right:16,width:250},children:[t.jsxs("div",{className:"wim-video-menu-title",children:[t.jsx("span",{children:"プレイリスト"}),t.jsx("button",{onClick:()=>l(null),style:{marginLeft:"auto"},className:"wim-video-btn",children:t.jsx(r,{name:"CloseIcon",size:"small"})})]}),t.jsx("div",{className:"wim-video-menu-items",children:a?.map((e,n)=>t.jsx("button",{className:"wim-video-menu-btn","data-active":c===n,onClick:()=>{U(n),s.current&&(s.current.currentTime=0,setTimeout(()=>s.current?.play(),100))},style:{flexDirection:"column",alignItems:"flex-start",gap:4},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[c===n?t.jsx(r,{name:"PlayIcon",size:"small"}):t.jsx("div",{style:{width:20}}),t.jsx("span",{children:e.title||`Track ${n+1}`})]})},n))})]}),t.jsxs("div",{className:"wim-video-controls-bottom",children:[a&&a.length>0&&o&&t.jsx("button",{type:"button",className:"wim-video-btn",onClick:e=>{e.stopPropagation(),l(d==="playlist"?null:"playlist")},"aria-label":"Playlist",children:t.jsx(r,{name:"DocumentIcon",size:"small"})}),o&&t.jsx("button",{type:"button",className:"wim-video-btn",onClick:e=>{e.stopPropagation(),j(-10)},"aria-label":"Skip Backward 10s",children:t.jsx(r,{name:"ChevronLeftIcon",size:"small"})}),t.jsx("button",{type:"button",className:"wim-video-btn wim-video-btn--play",onClick:e=>{e.stopPropagation(),O()},"aria-label":k?"Pause":"Play",children:t.jsx(r,{name:k?"PauseIcon":"PlayIcon",size:"small"})}),o&&t.jsx("button",{type:"button",className:"wim-video-btn",onClick:e=>{e.stopPropagation(),j(10)},"aria-label":"Skip Forward 10s",children:t.jsx(r,{name:"ChevronRightIcon",size:"small"})}),a&&a.length>0&&o&&t.jsx("button",{type:"button",className:"wim-video-btn",onClick:e=>{e.stopPropagation(),c<a.length-1&&U(n=>n+1)},disabled:c>=a.length-1,style:{opacity:c>=a.length-1?.5:1},"aria-label":"Next track",children:t.jsx(r,{name:"ChevronRightIcon",size:"medium"})}),t.jsxs("div",{className:"wim-video-time-container",children:[t.jsx("span",{className:"wim-video-time__current",children:ee(D)}),t.jsxs("div",{className:"wim-video-progress-container",children:[t.jsx("input",{type:"range",min:"0",max:f||0,value:D,onChange:Ce,className:"wim-video-progress","aria-label":"Seek",onClick:e=>e.stopPropagation()}),t.jsx("div",{className:"wim-video-progress-fill",style:{width:`${D/(f||1)*100}%`}})]}),t.jsx("span",{className:"wim-video-time__total",children:ee(f)})]}),t.jsxs("div",{className:"wim-video-volume-container",children:[t.jsx("button",{type:"button",className:"wim-video-btn wim-video-btn--volume",onClick:e=>{e.stopPropagation(),Y()},"aria-label":b?"Unmute":"Mute",children:t.jsx(r,{name:b||v===0?"MuteIcon":"VolumeIcon",size:"small"})}),t.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:b?0:v,onChange:e=>{e.stopPropagation(),Te(e)},className:"wim-video-volume","aria-label":"Volume",onClick:e=>e.stopPropagation()})]}),o&&t.jsx("button",{type:"button",className:"wim-video-btn wim-video-btn--settings",onClick:e=>{e.stopPropagation(),l(d==="main"?null:"main")},"aria-label":"Settings",children:t.jsx(r,{name:"SettingsIcon",size:"small"})}),o&&t.jsx("button",{type:"button",className:"wim-video-btn",onClick:e=>{e.stopPropagation(),te()},"aria-label":"Picture in Picture",title:"ピクチャーインピクチャー",children:t.jsx(r,{name:"MonitorIcon",size:"small"})}),t.jsx("button",{type:"button",className:"wim-video-btn wim-video-btn--fullscreen",onClick:e=>{e.stopPropagation(),Z()},"aria-label":H?"Exit Fullscreen":"Fullscreen",children:t.jsx(r,{name:H?"MinimizeIcon":"MaximizeIcon",size:"small"})})]})]})]}),G&&t.jsx("figcaption",{className:"wim-video__caption",children:G})]})};re.__docgenInfo={description:"",methods:[],displayName:"Video",props:{src:{required:!1,tsType:{name:"string"},description:""},width:{required:!1,tsType:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}]},description:""},height:{required:!1,tsType:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}]},description:""},autoPlay:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},loop:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},muted:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},controls:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},poster:{required:!1,tsType:{name:"string"},description:""},radius:{required:!1,tsType:{name:"union",raw:'"none" | "small" | "medium" | "large" | "full"',elements:[{name:"literal",value:'"none"'},{name:"literal",value:'"small"'},{name:"literal",value:'"medium"'},{name:"literal",value:'"large"'},{name:"literal",value:'"full"'}]},description:"",defaultValue:{value:'"none"',computed:!1}},shadow:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},border:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},fit:{required:!1,tsType:{name:"union",raw:'"contain" | "cover" | "fill" | "none" | "scale-down"',elements:[{name:"literal",value:'"contain"'},{name:"literal",value:'"cover"'},{name:"literal",value:'"fill"'},{name:"literal",value:'"none"'},{name:"literal",value:'"scale-down"'}]},description:"",defaultValue:{value:'"cover"',computed:!1}},preload:{required:!1,tsType:{name:"union",raw:'"auto" | "metadata" | "none"',elements:[{name:"literal",value:'"auto"'},{name:"literal",value:'"metadata"'},{name:"literal",value:'"none"'}]},description:""},caption:{required:!1,tsType:{name:"string"},description:""},customControls:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},advancedControls:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},videoId:{required:!1,tsType:{name:"string"},description:""},resumePlayback:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},playlist:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ src: string; title?: string; poster?: string }",signature:{properties:[{key:"src",value:{name:"string",required:!0}},{key:"title",value:{name:"string",required:!1}},{key:"poster",value:{name:"string",required:!1}}]}}],raw:"{ src: string; title?: string; poster?: string }[]"},description:""},autoPlayNext:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},qualities:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ label: string; src: string }",signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"src",value:{name:"string",required:!0}}]}}],raw:"{ label: string; src: string }[]"},description:""}}};const m=""+new URL("videosample-j4XSMn77.mp4",import.meta.url).href,g=""+new URL("imagesanple-j58eW6sL.webp",import.meta.url).href,ze={title:"Components/Media/Video",component:re,parameters:{layout:"centered"},argTypes:{radius:{control:"select",options:["none","small","medium","large","full"]},fit:{control:"select",options:["contain","cover","fill","none","scale-down"]}}},T={args:{src:m,poster:g,width:600}},I={args:{src:m,poster:g,width:600,autoPlay:!0,muted:!0,loop:!0,controls:!1,caption:"自動再生＆ループ設定（ミュート必須）"}},S={args:{src:m,poster:g,width:400,radius:"large",shadow:!0}},V={args:{src:m,poster:g,width:600,customControls:!0,radius:"medium",shadow:!0,caption:"カスタムコントロール付きビデオ"}},F={name:"Full Featured",args:{width:800,videoId:"sample-demo-vid",resumePlayback:!0,autoPlayNext:!0,controls:!1,radius:"large",shadow:!0,border:!0,fit:"cover",preload:"auto",caption:"全機能（全部盛り）プレーヤー: 画質変更・速度・フィット・プレイリスト・レジューム再生",customControls:!0,advancedControls:!0,qualities:[{label:"1080p",src:m},{label:"720p",src:m},{label:"Auto",src:m}],playlist:[{src:m,title:"エピソード 1: はじまり",poster:g},{src:m,title:"エピソード 2: 展開",poster:g},{src:m,title:"エピソード 3: 結末",poster:g}]}};T.parameters={...T.parameters,docs:{...T.parameters?.docs,source:{originalSource:`{
  args: {
    src: sampleVideo,
    poster: videoPoster,
    width: 600
  }
}`,...T.parameters?.docs?.source}}};I.parameters={...I.parameters,docs:{...I.parameters?.docs,source:{originalSource:`{
  args: {
    src: sampleVideo,
    poster: videoPoster,
    width: 600,
    autoPlay: true,
    muted: true,
    loop: true,
    controls: false,
    caption: "自動再生＆ループ設定（ミュート必須）"
  }
}`,...I.parameters?.docs?.source}}};S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:`{
  args: {
    src: sampleVideo,
    poster: videoPoster,
    width: 400,
    radius: "large",
    shadow: true
  }
}`,...S.parameters?.docs?.source}}};V.parameters={...V.parameters,docs:{...V.parameters?.docs,source:{originalSource:`{
  args: {
    src: sampleVideo,
    poster: videoPoster,
    width: 600,
    customControls: true,
    radius: "medium",
    shadow: true,
    caption: "カスタムコントロール付きビデオ"
  }
}`,...V.parameters?.docs?.source}}};F.parameters={...F.parameters,docs:{...F.parameters?.docs,source:{originalSource:`{
  name: "Full Featured",
  args: {
    width: 800,
    videoId: "sample-demo-vid",
    resumePlayback: true,
    autoPlayNext: true,
    controls: false,
    radius: "large",
    shadow: true,
    border: true,
    fit: "cover",
    preload: "auto",
    caption: "全機能（全部盛り）プレーヤー: 画質変更・速度・フィット・プレイリスト・レジューム再生",
    customControls: true,
    advancedControls: true,
    qualities: [{
      label: "1080p",
      src: sampleVideo
    }, {
      label: "720p",
      src: sampleVideo
    }, {
      label: "Auto",
      src: sampleVideo
    }],
    playlist: [{
      src: sampleVideo,
      title: "エピソード 1: はじまり",
      poster: videoPoster
    }, {
      src: sampleVideo,
      title: "エピソード 2: 展開",
      poster: videoPoster
    }, {
      src: sampleVideo,
      title: "エピソード 3: 結末",
      poster: videoPoster
    }]
  }
}`,...F.parameters?.docs?.source}}};const Ee=["Default","AutoPlay","Rounded","CustomControls","FullFeatured"],_e=Object.freeze(Object.defineProperty({__proto__:null,AutoPlay:I,CustomControls:V,Default:T,FullFeatured:F,Rounded:S,__namedExportsOrder:Ee,default:ze},Symbol.toStringTag,{value:"Module"}));export{I as A,V as C,T as D,F,S as R,_e as V};
