import{j as s}from"./jsx-runtime-u17CrQMm.js";import{r as l,R as $}from"./iframe-BUrtav60.js";import{c as h}from"./index-Drm8gX_j.js";import{I as ee}from"./Icon-COj0gwfh.js";const z=({options:c=[],value:L,onChange:_,placeholder:G="Select an option",label:M,className:H,disabled:p=!1,defaultValue:U,searchable:O=!1,searchPlaceholder:B="Search...",filterOption:V,grouped:C=!1,...J})=>{const[o,m]=l.useState(!1),[Q,X]=l.useState(U||""),[f,g]=l.useState(""),[u,i]=l.useState(-1),D=l.useRef(null),N=l.useRef(null),T=l.useRef(null),k=l.useRef([]),A=L!==void 0,E=A?L:Q,q=l.useMemo(()=>C&&c.length>0&&"options"in c[0]?c.flatMap(e=>e.options):c,[c,C]),n=l.useMemo(()=>{if(!f)return q;const r=V||((a,t)=>a.label.toLowerCase().includes(t.toLowerCase()));return q.filter(a=>r(a,f))},[q,f,V]),I=q.find(e=>e.value===E);l.useEffect(()=>{const e=r=>{D.current&&!D.current.contains(r.target)&&(m(!1),g(""),i(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),l.useEffect(()=>{o&&O&&T.current&&T.current.focus()},[o,O]),l.useEffect(()=>{u>=0&&k.current[u]&&k.current[u]?.scrollIntoView({block:"nearest",behavior:"smooth"})},[u]);const Y=()=>{p||(m(!o),o||(g(""),i(-1)))},R=e=>{e.disabled||(A||X(e.value),_&&_(e.value),m(!1),g(""),i(-1),N.current?.focus())},W=e=>{if(!p)switch(e.key){case"Enter":case" ":o?u>=0&&n[u]&&R(n[u]):m(!0),e.preventDefault();break;case"Escape":m(!1),g(""),i(-1),N.current?.focus(),e.preventDefault();break;case"ArrowDown":e.preventDefault(),o?i(r=>{const a=r+1;if(a>=n.length)return 0;if(n[a]?.disabled){let t=a+1;for(;t<n.length&&n[t]?.disabled;)t++;return t<n.length?t:r}return a}):m(!0);break;case"ArrowUp":e.preventDefault(),o&&i(r=>{if(r<=0)return n.length-1;const a=r-1;if(n[a]?.disabled){let t=a-1;for(;t>=0&&n[t]?.disabled;)t--;return t>=0?t:r}return a});break;case"Home":o&&(e.preventDefault(),i(0));break;case"End":o&&(e.preventDefault(),i(n.length-1));break}},Z=()=>{if(C&&c.length>0&&"options"in c[0]){const e=c;let r=0;return e.map((a,t)=>{const b=a.options.filter(d=>!f||(V||((x,P)=>x.label.toLowerCase().includes(P.toLowerCase())))(d,f));return b.length===0?null:s.jsxs($.Fragment,{children:[s.jsx("li",{className:"wim-selectbox-group-label",role:"presentation",children:a.label}),b.map(d=>{const x=r++,P=x===u,K=E===d.value;return s.jsx("li",{ref:F=>{k.current[x]=F},className:h("wim-selectbox-option",K&&"wim-selectbox-option--selected",d.disabled&&"wim-selectbox-option--disabled",P&&"wim-selectbox-option--focused"),onClick:F=>{F.stopPropagation(),R(d)},onMouseEnter:()=>i(x),role:"option","aria-selected":K,"aria-disabled":d.disabled,children:d.label},d.value)})]},t)})}return n.map((e,r)=>{const a=r===u,t=E===e.value;return s.jsx("li",{ref:b=>{k.current[r]=b},className:h("wim-selectbox-option",t&&"wim-selectbox-option--selected",e.disabled&&"wim-selectbox-option--disabled",a&&"wim-selectbox-option--focused"),onClick:b=>{b.stopPropagation(),R(e)},onMouseEnter:()=>i(r),role:"option","aria-selected":t,"aria-disabled":e.disabled,children:e.label},e.value)})};return s.jsxs("div",{className:h("wim-selectbox",H),ref:D,...J,children:[M&&s.jsx("label",{className:"wim-label",children:M}),s.jsxs("div",{className:h("wim-selectbox-trigger",o&&"wim-selectbox-trigger--open",p&&"wim-selectbox-trigger--disabled"),onClick:Y,onKeyDown:W,tabIndex:p?-1:0,role:"combobox","aria-expanded":o,"aria-haspopup":"listbox","aria-disabled":p,ref:N,children:[s.jsx("div",{className:h("wim-selectbox-value",!I&&"wim-selectbox-value--placeholder"),children:I?I.label:G}),s.jsx("div",{className:"wim-selectbox-icon",children:s.jsx(ee,{name:"ChevronDownIcon",size:"medium"})})]}),o&&!p&&s.jsxs("div",{className:"wim-selectbox-dropdown",children:[O&&s.jsx("div",{className:"wim-selectbox-search",children:s.jsx("input",{ref:T,type:"text",className:"wim-selectbox-search-input",placeholder:B,value:f,onChange:e=>{g(e.target.value),i(-1)},onClick:e=>e.stopPropagation(),onKeyDown:W})}),s.jsx("ul",{className:"wim-selectbox-list",role:"listbox",children:n.length===0?s.jsx("li",{className:"wim-selectbox-empty",children:"No options found"}):Z()})]})]})};z.__docgenInfo={description:"ユーザーが定義済みの選択肢から1つを選択するためのプルダウンメニュー。",methods:[],displayName:"Selectbox",props:{options:{required:!1,tsType:{name:"union",raw:"SelectboxOption[] | SelectboxOptionGroup[]",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label: string;\r
    value: string;\r
    disabled?: boolean;\r
    group?: string;\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}}]}}],raw:"SelectboxOption[]"},{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label: string;\r
    options: SelectboxOption[];\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label: string;\r
    value: string;\r
    disabled?: boolean;\r
    group?: string;\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}}]}}],raw:"SelectboxOption[]",required:!0}}]}}],raw:"SelectboxOptionGroup[]"}]},description:"",defaultValue:{value:"[]",computed:!1}},value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"Select an option"',computed:!1}},label:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},defaultValue:{required:!1,tsType:{name:"string"},description:""},searchable:{required:!1,tsType:{name:"boolean"},description:"Enable search/filtering functionality",defaultValue:{value:"false",computed:!1}},searchPlaceholder:{required:!1,tsType:{name:"string"},description:"Placeholder text for search input",defaultValue:{value:'"Search..."',computed:!1}},filterOption:{required:!1,tsType:{name:"signature",type:"function",raw:"(option: SelectboxOption, searchValue: string) => boolean",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{\r
    label: string;\r
    value: string;\r
    disabled?: boolean;\r
    group?: string;\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}}]}},name:"option"},{type:{name:"string"},name:"searchValue"}],return:{name:"boolean"}}},description:"Custom filter function"},grouped:{required:!1,tsType:{name:"boolean"},description:"Whether options are grouped",defaultValue:{value:"false",computed:!1}}}};const te={title:"Component/Selection Controls/Selectbox",component:z,parameters:{layout:"centered",docs:{description:{component:"ユーザーが定義済みの選択肢から1つを選択するためのコンポーネント。"}}},tags:[],argTypes:{onChange:{action:"changed"}}},j=[{label:"Option 1",value:"opt1"},{label:"Option 2",value:"opt2"},{label:"Option 3",value:"opt3"},{label:"Disabled Option",value:"opt4",disabled:!0},{label:"Option 5",value:"opt5"}],v={args:{options:j,placeholder:"Select an option..."}},w={args:{label:"Choose an item",options:j,placeholder:"Select..."}},y={args:{options:j,defaultValue:"opt2"}},S={args:{options:j,disabled:!0,defaultValue:"opt1"}};v.parameters={...v.parameters,docs:{...v.parameters?.docs,source:{originalSource:`{
  args: {
    options: options,
    placeholder: "Select an option..."
  }
}`,...v.parameters?.docs?.source}}};w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:`{
  args: {
    label: "Choose an item",
    options: options,
    placeholder: "Select..."
  }
}`,...w.parameters?.docs?.source}}};y.parameters={...y.parameters,docs:{...y.parameters?.docs,source:{originalSource:`{
  args: {
    options: options,
    defaultValue: "opt2"
  }
}`,...y.parameters?.docs?.source}}};S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:`{
  args: {
    options: options,
    disabled: true,
    defaultValue: "opt1"
  }
}`,...S.parameters?.docs?.source}}};const ae=["Default","WithLabel","Preselected","Disabled"],oe=Object.freeze(Object.defineProperty({__proto__:null,Default:v,Disabled:S,Preselected:y,WithLabel:w,__namedExportsOrder:ae,default:te},Symbol.toStringTag,{value:"Module"}));export{v as D,y as P,oe as S,w as W,S as a};
