import{j as s}from"./jsx-runtime-u17CrQMm.js";import{r as n,R as J}from"./iframe-CLXnzuMj.js";import{c as v}from"./index-DIcffr0b.js";import{I as Q}from"./Icon-CfK0pkXv.js";const X=({options:c=[],value:T,onChange:R,placeholder:P="Select an option",label:D,className:K,disabled:m=!1,defaultValue:G,searchable:y=!1,searchPlaceholder:_="Search...",filterOption:k,grouped:q=!1,...z})=>{const[i,f]=n.useState(!1),[H,U]=n.useState(G||""),[p,g]=n.useState(""),[u,o]=n.useState(-1),S=n.useRef(null),j=n.useRef(null),N=n.useRef(null),h=n.useRef([]),F=n.useRef("wim-selectbox-list-"+Math.random().toString(36).substr(2,9)).current,L=T!==void 0,V=L?T:H,w=n.useMemo(()=>q&&c.length>0&&"options"in c[0]?c.flatMap(e=>e.options):c,[c,q]),l=n.useMemo(()=>{if(!p)return w;const a=k||((r,t)=>r.label.toLowerCase().includes(t.toLowerCase()));return w.filter(r=>a(r,p))},[w,p,k]),I=w.find(e=>e.value===V);n.useEffect(()=>{const e=a=>{S.current&&!S.current.contains(a.target)&&(f(!1),g(""),o(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),n.useEffect(()=>{i&&y&&N.current&&N.current.focus()},[i,y]),n.useEffect(()=>{u>=0&&h.current[u]&&h.current[u]?.scrollIntoView({block:"nearest",behavior:"smooth"})},[u]);const W=()=>{m||(f(!i),i||(g(""),o(-1)))},O=e=>{e.disabled||(L||U(e.value),R&&R(e.value),f(!1),g(""),o(-1),j.current?.focus())},M=e=>{if(!m)switch(e.key){case"Enter":case" ":i?u>=0&&l[u]&&O(l[u]):f(!0),e.preventDefault();break;case"Escape":f(!1),g(""),o(-1),j.current?.focus(),e.preventDefault();break;case"ArrowDown":e.preventDefault(),i?o(a=>{const r=a+1;if(r>=l.length)return 0;if(l[r]?.disabled){let t=r+1;for(;t<l.length&&l[t]?.disabled;)t++;return t<l.length?t:a}return r}):f(!0);break;case"ArrowUp":e.preventDefault(),i&&o(a=>{if(a<=0)return l.length-1;const r=a-1;if(l[r]?.disabled){let t=r-1;for(;t>=0&&l[t]?.disabled;)t--;return t>=0?t:a}return r});break;case"Home":i&&(e.preventDefault(),o(0));break;case"End":i&&(e.preventDefault(),o(l.length-1));break}},B=()=>{if(q&&c.length>0&&"options"in c[0]){const e=c;let a=0;return e.map((r,t)=>{const b=r.options.filter(d=>!p||(k||((x,C)=>x.label.toLowerCase().includes(C.toLowerCase())))(d,p));return b.length===0?null:s.jsxs(J.Fragment,{children:[s.jsx("li",{className:"wim-selectbox-group-label",role:"presentation",children:r.label}),b.map(d=>{const x=a++,C=x===u,A=V===d.value;return s.jsx("li",{ref:E=>{h.current[x]=E},className:v("wim-selectbox-option",A&&"wim-selectbox-option--selected",d.disabled&&"wim-selectbox-option--disabled",C&&"wim-selectbox-option--focused"),onClick:E=>{E.stopPropagation(),O(d)},onMouseEnter:()=>o(x),role:"option","aria-selected":A,"aria-disabled":d.disabled,children:d.label},d.value)})]},t)})}return l.map((e,a)=>{const r=a===u,t=V===e.value;return s.jsx("li",{ref:b=>{h.current[a]=b},className:v("wim-selectbox-option",t&&"wim-selectbox-option--selected",e.disabled&&"wim-selectbox-option--disabled",r&&"wim-selectbox-option--focused"),onClick:b=>{b.stopPropagation(),O(e)},onMouseEnter:()=>o(a),role:"option","aria-selected":t,"aria-disabled":e.disabled,children:e.label},e.value)})};return s.jsxs("div",{className:v("wim-selectbox",K),ref:S,...z,children:[D&&s.jsx("label",{className:"wim-label",children:D}),s.jsxs("div",{className:v("wim-selectbox-trigger",i&&"wim-selectbox-trigger--open",m&&"wim-selectbox-trigger--disabled"),onClick:W,onKeyDown:M,tabIndex:m?-1:0,role:"combobox","aria-expanded":i,"aria-haspopup":"listbox","aria-controls":F,"aria-disabled":m,ref:j,children:[s.jsx("div",{className:v("wim-selectbox-value",!I&&"wim-selectbox-value--placeholder"),children:I?I.label:P}),s.jsx("div",{className:"wim-selectbox-icon",children:s.jsx(Q,{name:"ChevronDownIcon",size:"medium"})})]}),i&&!m&&s.jsxs("div",{className:"wim-selectbox-dropdown",children:[y&&s.jsx("div",{className:"wim-selectbox-search",children:s.jsx("input",{ref:N,type:"text",className:"wim-selectbox-search-input",placeholder:_,value:p,onChange:e=>{g(e.target.value),o(-1)},onClick:e=>e.stopPropagation(),onKeyDown:M})}),s.jsx("ul",{id:F,className:"wim-selectbox-list",role:"listbox",children:l.length===0?s.jsx("li",{className:"wim-selectbox-empty",children:"No options found"}):B()})]})]})};X.__docgenInfo={description:"ユーザーが定義済みの選択肢から1つを選択するためのプルダウンメニュー。",methods:[],displayName:"Selectbox",props:{options:{required:!1,tsType:{name:"union",raw:"SelectboxOption[] | SelectboxOptionGroup[]",elements:[{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label: string;\r
    value: string;\r
    disabled?: boolean;\r
    group?: string;\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}}]}}],raw:"SelectboxOption[]"},{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label: string;\r
    options: SelectboxOption[];\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"options",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{\r
    label: string;\r
    value: string;\r
    disabled?: boolean;\r
    group?: string;\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}}]}}],raw:"SelectboxOption[]",required:!0}}]}}],raw:"SelectboxOptionGroup[]"}]},description:"",defaultValue:{value:"[]",computed:!1}},value:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"Select an option"',computed:!1}},label:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},defaultValue:{required:!1,tsType:{name:"string"},description:""},searchable:{required:!1,tsType:{name:"boolean"},description:"Enable search/filtering functionality",defaultValue:{value:"false",computed:!1}},searchPlaceholder:{required:!1,tsType:{name:"string"},description:"Placeholder text for search input",defaultValue:{value:'"Search..."',computed:!1}},filterOption:{required:!1,tsType:{name:"signature",type:"function",raw:"(option: SelectboxOption, searchValue: string) => boolean",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{\r
    label: string;\r
    value: string;\r
    disabled?: boolean;\r
    group?: string;\r
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}},{key:"group",value:{name:"string",required:!1}}]}},name:"option"},{type:{name:"string"},name:"searchValue"}],return:{name:"boolean"}}},description:"Custom filter function"},grouped:{required:!1,tsType:{name:"boolean"},description:"Whether options are grouped",defaultValue:{value:"false",computed:!1}}}};export{X as S};
