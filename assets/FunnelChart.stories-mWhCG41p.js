import{j as x}from"./jsx-runtime-u17CrQMm.js";import{W as ae,_ as re,$ as ie,r as ne,a0 as oe,h as le,d as J,l as se,L as D,a1 as ue,X as z,a2 as pe,a3 as de,a5 as E,ac as me,ba as ce,y as ve,af as fe,v as he,x as ge,C as X}from"./helpers-B6O5pXvQ.js";import{r as o}from"./iframe-UkWjFSao.js";import{C as ye}from"./CartesianChart-CkZekchL.js";import{T as be}from"./Tooltip-BuMylR3m.js";import{o as we}from"./omit-DPAS2tZF.js";import{c as Pe,f as Oe,L as Ee,d as xe,e as Te}from"./CategoricalChart-D-nDAMBG.js";import{S as je}from"./ActiveShapeUtils-BiTAwY7z.js";import{C as Q,u as Se,a as Ae,b as Ce}from"./tooltipContext-C5FzhTHS.js";import"./index-XPOYBE6I.js";import"./index-BRQVn5SA.js";import"./index-B9DlqdPD.js";import"./preload-helper-PPVm8Dsz.js";import"./isPlainObject-ClVMfR8O.js";function _(){return _=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},_.apply(null,arguments)}function We(e){return o.createElement(je,_({shapeType:"trapezoid"},e))}function Y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Y(Object(a),!0).forEach(function(r){Ke(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function Ke(e,t,a){return(t=ze(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ze(e){var t=Fe(e,"string");return typeof t=="symbol"?t:t+""}function Fe(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ie=(e,t)=>t,ke=ae([re,Ie,ie],(e,t,a)=>{var{data:r,dataKey:s,nameKey:l,tooltipType:f,lastShapeType:v,reversed:w,customWidth:P,cells:c,presentationProps:g,id:b}=t,{chartData:i}=a,u;if(r!=null&&r.length>0?u=r:i!=null&&i.length>0&&(u=i),u&&u.length)u=u.map((h,O)=>C(C(C({payload:h},g),h),c&&c[O]&&c[O].props));else if(c&&c.length)u=c.map(h=>C(C({},g),h.props));else return[];return Ue({dataKey:s,nameKey:l,displayedData:u,tooltipType:f,lastShapeType:v,reversed:w,offset:e,customWidth:P,graphicalItemId:b})}),_e=["onMouseEnter","onClick","onMouseLeave","shape","activeShape"],De=["id"],Le=["stroke","fill","legendType","hide","isAnimationActive","animationBegin","animationDuration","animationEasing","nameKey","lastShapeType","id"],Me=["id"];function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},W.apply(null,arguments)}function I(e,t){if(e==null)return{};var a,r,s=Be(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}function Be(e,t){if(e==null)return{};var a={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;a[r]=e[r]}return a}function G(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,r)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?G(Object(a),!0).forEach(function(r){Re(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):G(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function Re(e,t,a){return(t=Ve(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ve(e){var t=$e(e,"string");return typeof t=="symbol"?t:t+""}function $e(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var r=a.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ne=o.memo(e=>{var{dataKey:t,nameKey:a,stroke:r,strokeWidth:s,fill:l,name:f,hide:v,tooltipType:w,data:P,trapezoids:c,id:g}=e,b={dataDefinedOnItem:P,getPosition:i=>{var u;return(u=c[Number(i)])===null||u===void 0?void 0:u.tooltipPosition},settings:{stroke:r,strokeWidth:s,fill:l,dataKey:t,name:f,nameKey:a,hide:v,type:w,color:l,unit:"",graphicalItemId:g}};return o.createElement(ue,{tooltipEntrySettings:b})});function He(e){var{showLabels:t,trapezoids:a,children:r}=e,s=o.useMemo(()=>{if(t)return a?.map(l=>{var f=l.labelViewBox;return y(y({},f),{},{value:l.name,payload:l.payload,parentViewBox:l.parentViewBox,viewBox:f,fill:l.fill})})},[t,a]);return o.createElement(xe,{value:s},r)}function qe(e){var{trapezoids:t,allOtherFunnelProps:a}=e,r=J(i=>ce(i,"item",i.tooltip.settings.trigger,void 0)),{onMouseEnter:s,onClick:l,onMouseLeave:f,shape:v,activeShape:w}=a,P=I(a,_e),c=Se(s,a.dataKey,a.id),g=Ae(f),b=Ce(l,a.dataKey,a.id);return o.createElement(o.Fragment,null,t.map((i,u)=>{var h=!!w&&r===String(u),O=h?w:v,n=y(y({},i),{},{option:O,isActive:h,stroke:i.stroke}),{id:T}=n,d=I(n,De);return o.createElement(D,W({key:"trapezoid-".concat(i?.x,"-").concat(i?.y,"-").concat(i?.name,"-").concat(i?.value),className:"recharts-funnel-trapezoid"},ve(P,i,u),{onMouseEnter:c(i,u),onMouseLeave:g(i,u),onClick:b(i,u)}),o.createElement(We,d))}))}function Xe(e){var{previousTrapezoidsRef:t,props:a}=e,{trapezoids:r,isAnimationActive:s,animationBegin:l,animationDuration:f,animationEasing:v,onAnimationEnd:w,onAnimationStart:P}=a,c=t.current,[g,b]=o.useState(!1),i=!g,u=pe(r,"recharts-funnel-"),h=o.useCallback(()=>{typeof w=="function"&&w(),b(!1)},[w]),O=o.useCallback(()=>{typeof P=="function"&&P(),b(!0)},[P]);return o.createElement(He,{showLabels:i,trapezoids:r},o.createElement(de,{animationId:u,begin:l,duration:f,isActive:s,easing:v,key:u,onAnimationStart:O,onAnimationEnd:h},n=>{var T=n===1?r:r.map((d,p)=>{var m=c&&c[p];return m?y(y({},d),{},{x:E(m.x,d.x,n),y:E(m.y,d.y,n),upperWidth:E(m.upperWidth,d.upperWidth,n),lowerWidth:E(m.lowerWidth,d.lowerWidth,n),height:E(m.height,d.height,n)}):y(y({},d),{},{x:E(d.x+d.upperWidth/2,d.x,n),y:E(d.y+d.height/2,d.y,n),upperWidth:E(0,d.upperWidth,n),lowerWidth:E(0,d.lowerWidth,n),height:E(0,d.height,n)})});return n>0&&(t.current=T),o.createElement(D,null,o.createElement(qe,{trapezoids:T,allOtherFunnelProps:a}))}),o.createElement(Ee,{label:a.label}),a.children)}function Ye(e){var t=o.useRef(void 0);return o.createElement(Xe,{props:e,previousTrapezoidsRef:t})}var Ge=(e,t)=>{var{width:a,height:r,left:s,top:l}=t,f=me(e,a,a);return{realWidth:f,realHeight:r,offsetX:s,offsetY:l}},Je={animationBegin:400,animationDuration:1500,animationEasing:"ease",fill:"#808080",hide:!1,isAnimationActive:"auto",lastShapeType:"triangle",legendType:"rect",nameKey:"name",reversed:!1,stroke:"#fff"};function Qe(e){var t=Pe(),{stroke:a,fill:r,legendType:s,hide:l,isAnimationActive:f,animationBegin:v,animationDuration:w,animationEasing:P,nameKey:c,lastShapeType:g,id:b}=e,i=I(e,Le),u=le(e),h=Oe(e.children,Q),O=o.useMemo(()=>({dataKey:e.dataKey,nameKey:c,data:e.data,tooltipType:e.tooltipType,lastShapeType:g,reversed:e.reversed,customWidth:e.width,cells:h,presentationProps:u,id:b}),[e.dataKey,c,e.data,e.tooltipType,g,e.reversed,e.width,h,u,b]),n=J(m=>ke(m,O));if(l||!n||!n.length||!t)return null;var{height:T,width:d}=t,p=se("recharts-trapezoids",e.className);return o.createElement(o.Fragment,null,o.createElement(Ne,{dataKey:e.dataKey,nameKey:e.nameKey,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,data:e.data,trapezoids:n,id:b}),o.createElement(D,{className:p},o.createElement(Ye,W({},i,{id:b,stroke:a,fill:r,nameKey:c,lastShapeType:g,animationBegin:v,animationDuration:w,animationEasing:P,isAnimationActive:f,hide:l,legendType:s,height:T,width:d,trapezoids:n}))))}function Ue(e){var{dataKey:t,nameKey:a,displayedData:r,tooltipType:s,lastShapeType:l,reversed:f,offset:v,customWidth:w,graphicalItemId:P}=e,{realHeight:c,realWidth:g,offsetX:b,offsetY:i}=Ge(w,v),u=r.map(p=>{var m=z(p,t,0);return typeof m=="number"?m:0}),h=Math.max.apply(null,u),O=r.length,n=c/O,T={x:v.left,y:v.top,width:v.width,height:v.height},d=r.map((p,m)=>{var j=z(p,t,0),L=String(z(p,a,m)),S=j,A;if(m!==O-1){var K=z(r[m+1],t,0);if(typeof K=="number")A=K;else if(Array.isArray(K)){var[M,B]=K;typeof M=="number"&&(S=M),typeof B=="number"&&(A=B)}}else if(j instanceof Array&&j.length===2){var[R,V]=j;typeof R=="number"&&(S=R),typeof V=="number"&&(A=V)}else l==="rectangle"?A=S:A=0;var $=(h-S)*g/(2*h)+b,N=n*m+i,k=S/h*g,H=A/h*g,ee=[{name:L,value:S,payload:p,dataKey:t,type:s,graphicalItemId:P}],te={x:$+k/2,y:N+n/2},q={x:$,y:N,upperWidth:k,lowerWidth:H,width:Math.max(k,H),height:n};return y(y(y({},q),{},{name:L,val:S,tooltipPayload:ee,tooltipPosition:te},p!=null&&typeof p=="object"?we(p,["width"]):{}),{},{payload:p,parentViewBox:T,labelViewBox:q})});return f&&(d=d.map((p,m)=>{var j={x:p.x-(p.lowerWidth-p.upperWidth)/2,y:p.y-m*n+(O-1-m)*n,upperWidth:p.lowerWidth,lowerWidth:p.upperWidth,width:Math.max(p.lowerWidth,p.upperWidth),height:n};return y(y(y({},p),j),{},{tooltipPosition:y(y({},p.tooltipPosition),{},{y:p.y-m*n+(O-1-m)*n+n/2}),labelViewBox:j})})),d}function U(e){var t=ne(e,Je),{id:a}=t,r=I(t,Me);return o.createElement(oe,{id:a,type:"funnel"},s=>o.createElement(Qe,W({},r,{id:s})))}U.displayName="Funnel";var Ze=["item"],et=o.forwardRef((e,t)=>o.createElement(ye,{chartName:"FunnelChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Ze,tooltipPayloadSearcher:fe,categoricalChartProps:e,ref:t}));const Z=({data:e,dataKey:t,nameKey:a,height:r=300,width:s="100%",title:l})=>x.jsxs("div",{style:{width:s,height:"auto"},children:[l&&x.jsx("h3",{style:{fontSize:"16px",marginBottom:"16px"},children:l}),x.jsx("div",{style:{height:r},children:x.jsx(he,{width:"100%",height:"100%",children:x.jsxs(et,{children:[x.jsx(be,{contentStyle:ge.tooltip.contentStyle}),x.jsxs(U,{dataKey:t,data:e,isAnimationActive:!0,children:[x.jsx(Te,{position:"right",fill:"#888",dataKey:a,stroke:"none"}),e.map((f,v)=>x.jsx(Q,{fill:X[v%X.length]},`cell-${v}`))]})]})})})]});Z.__docgenInfo={description:"",methods:[],displayName:"FunnelChart",props:{data:{required:!0,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:""},dataKey:{required:!0,tsType:{name:"string"},description:""},nameKey:{required:!0,tsType:{name:"string"},description:""},height:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"300",computed:!1}},width:{required:!1,tsType:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}]},description:"",defaultValue:{value:'"100%"',computed:!1}},title:{required:!1,tsType:{name:"string"},description:""}}};const ht={title:"Component/Visualization/FunnelChart",component:Z,tags:["autodocs"]},tt=[{value:100,name:"Impressions"},{value:80,name:"Clicks"},{value:50,name:"Cart"},{value:40,name:"Checkout"},{value:26,name:"Purchased"}],F={args:{title:"Sales Funnel",data:tt,dataKey:"value",nameKey:"name"}};F.parameters={...F.parameters,docs:{...F.parameters?.docs,source:{originalSource:`{
  args: {
    title: "Sales Funnel",
    data,
    dataKey: "value",
    nameKey: "name"
  }
}`,...F.parameters?.docs?.source}}};const gt=["Default"];export{F as Default,gt as __namedExportsOrder,ht as default};
